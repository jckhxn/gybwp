"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[305],{12195:function(e,t,n){let i;n.d(t,{AA:function(){return tE},BP:function(){return nS},Bh:function(){return tq},Cc:function(){return tS},HZ:function(){return e6},Hj:function(){return iD},Ie:function(){return no},Oo:function(){return nP},P0:function(){return iH},PF:function(){return nD},PV:function(){return tX},RL:function(){return te},Sg:function(){return op},Ty:function(){return nw},V$:function(){return e7},VQ:function(){return nQ},X6:function(){return tH},Z3:function(){return nC},aL:function(){return e9},aR:function(){return nO},c9:function(){return nl},cN:function(){return eG},cp:function(){return nf},ec:function(){return tV},eu:function(){return tk},ez:function(){return ie},fC:function(){return nr},hX:function(){return t9},hb:function(){return e8},iJ:function(){return e3},jE:function(){return n$},k$:function(){return ns},lU:function(){return eW},mE:function(){return t6},nK:function(){return nq},nR:function(){return tP},oK:function(){return iF},ud:function(){return e4},xu:function(){return n2},yq:function(){return tD},zY:function(){return nY},zc:function(){return iY}});var r,o,l,s,a,c,d,u,p,h,m,f,x,g,y,v,b,j,w,I,C,_,T,k,E,P,A,D,S,R,O,z,M,L,U,N,H,V,B,Z,F,q,$=n(45211),Q=n(2265),Y=n(57437),G=n(42299),W=n(28501),X=n(91806),J=n(55531),K=n(46520),ee=n(69551),et=n(29314),en=n(85147),ei=n(72211),er=n(45685),eo=n(67581),el=n(89402),es=n(49086),ea=n(50998),ec=n(3221),ed=n(86781),eu=n.n(ed),ep=n(71881),eh=n.n(ep),em=n(33874),ef=n.n(em),ex=n(63070),eg=n(62740),ey=n(25727),ev=n.n(ey),eb=n(38146),ej=n(83705),ew=n.n(ej),eI=n(56567),eC=n.n(eI),e_=n(31207),eT=n(55894),ek=n(47453),eE=n(21008),eP=n.n(eE),eA=n(86566),eD=n(71294),eS=n(72140),eR=n.n(eS),eO=n(31423),ez=n.n(eO),eM=n(48911),eL=n.n(eM),eU=n(44601),eN=n.n(eU),eH=n(53530),eV=n.n(eH),eB=n(94468),eZ=n.n(eB),eF=n(65574),eq=n.n(eF),e$=n(25794),eQ=n(35794),eY=n.n(eQ);function eG(e){let{children:t,ms:n=0}=e,[i,r]=(0,Q.useState)(n<=0);return((0,Q.useEffect)(()=>{if(n<=0)return;let e=setTimeout(()=>r(!0),n);return()=>{clearTimeout(e)}},[n]),i&&t)?"function"==typeof t?t():t:(0,Y.jsx)(Y.Fragment,{})}function eW(e){let{document:t}=e,n=(0,G.I_y)(),i=n.get(t._type),{error:r,value:o}=(0,G._2T)({schemaType:i,value:t});return i?r?(0,Y.jsxs)(Y.Fragment,{children:["Error: ",r.message]}):(0,Y.jsx)(Y.Fragment,{children:(null==o?void 0:o.title)||(0,Y.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})}):(0,Y.jsxs)("code",{children:["Unknown schema type: ",t._type]})}function eX(e){let{time:t}=e,n=(0,G.INm)(t);return(0,Y.jsxs)("span",{title:n,children:[n," ago"]})}let eJ=()=>(i||(i=(0,J.R)(document,"visibilitychange").pipe((0,ei.O)(null),(0,er.U)(()=>"visible"===document.visibilityState),(0,eo.x)(),(0,el.w)(e=>e?(0,K.H)(0,5e3):ee.E),(0,es.d)({refCount:!0,bufferSize:1}))),i),eK=(0,G.ek8)(e=>{let[t,n]=e,i='{"references":'.concat("*[references($documentId)][0...100]{_id,_type}",',"totalCount":').concat("count(*[references($documentId)])","}");return n.listenQuery({fetch:i,listen:"*[references($documentId)]"},{documentId:t},{tag:"use-referring-documents",transitions:["appear","disappear"],throttleTime:5e3})}),e0=(0,G.ek8)(e=>{let[t,n]=e;return eJ().pipe((0,el.w)(()=>(function(e,t){let{versionedClient:n}=t;return eJ().pipe((0,el.w)(()=>(function(e,t){let{versionedClient:n}=t,i=(0,G.qyu)(e),r=(0,G.vsM)(e),o={uri:n.getDataUrl("doc","".concat(i,",").concat(r)),json:!0,query:{excludeContent:"true"},tag:"use-referring-documents.document-existence"};return n.observable.request(o).pipe((0,er.U)(e=>{let{omitted:t}=e,n=t.filter(e=>"existence"===e.reason);return 2===n.length?void 0:0===n.length?r:n.some(e=>e.id===i)?r:i}))})(e,t)),(0,el.w)(e=>{if(!e)return(0,et.of)({totalCount:0,references:[]});let t=n.config().dataset;return n.observable.request({url:"/data/references/".concat(t,"/documents/").concat(e,"/to?excludeInternalReferences=true&excludePaths=true"),tag:"use-referring-documents.external"}).pipe((0,ea.K)(e=>{if("object"==typeof e&&e&&"statusCode"in e&&"response"in e&&404===e.statusCode)return(0,et.of)({totalCount:0,references:[]});throw e}))}))})(t,{versionedClient:n})))});function e1(e){let{document:t}=e,n=t&&"_updatedAt"in t&&t._updatedAt;return(0,Y.jsx)(W.u,{portal:!0,content:(0,Y.jsx)(W.xu,{padding:2,children:(0,Y.jsx)(W.xv,{size:1,children:t?(0,Y.jsxs)(Y.Fragment,{children:["Published ",n&&(0,Y.jsx)(eX,{time:n})]}):(0,Y.jsx)(Y.Fragment,{children:"Not published"})})}),children:(0,Y.jsx)(G.LPT,{tone:"positive",dimmed:!t,muted:!t,size:1,children:(0,Y.jsx)($.EI4,{"aria-label":t?"Published":"Not published"})})})}function e2(e){let{document:t}=e,n=t&&"_updatedAt"in t&&t._updatedAt;return(0,Y.jsx)(W.u,{portal:!0,content:(0,Y.jsx)(W.xu,{padding:2,children:(0,Y.jsx)(W.xv,{size:1,children:t?(0,Y.jsxs)(Y.Fragment,{children:["Edited ",n&&(0,Y.jsx)(eX,{time:n})]}):(0,Y.jsx)(Y.Fragment,{children:"No unpublished edits"})})}),children:(0,Y.jsx)(G.LPT,{tone:"caution",dimmed:!t,muted:!t,size:1,children:(0,Y.jsx)($.dY8,{})})})}function e3(e){let{icon:t,layout:n,presence:i,schemaType:r,value:o}=e,l=(0,G.Uy$)(o.title)&&(0,Q.isValidElement)(o.title)||ef()(o.title)||eh()(o.title)?o.title:null,{draft:s,published:a,isLoading:c}=(0,ex.m2)(()=>(0,G.eLL)(e.documentPreviewStore,r,o._id,l),[e.documentPreviewStore,r,o._id,l]),d=c?null:(0,Y.jsxs)(W.gF,{space:4,children:[i&&i.length>0&&(0,Y.jsx)(G.mEJ,{presence:i}),(0,Y.jsx)(e1,{document:a}),(0,Y.jsx)(e2,{document:s})]});return(0,Y.jsx)(G.ogX,{...(0,G.L_b)({value:o,draft:s,published:a}),isPlaceholder:c,icon:t,layout:n,status:d})}function e5(){throw Error("Pane is missing router context")}let e4=(0,Q.createContext)({index:0,groupIndex:0,siblingIndex:0,payload:void 0,params:{},hasGroupSiblings:!1,groupLength:0,routerPanesState:[],BackLink:()=>e5(),ChildLink:()=>e5(),ReferenceChildLink:()=>e5(),handleEditReference:()=>e5(),ParameterizedLink:()=>e5(),replaceCurrent:()=>e5(),closeCurrent:()=>e5(),duplicateCurrent:()=>e5(),setView:()=>e5(),setParams:()=>e5(),setPayload:()=>e5(),navigateIntent:()=>e5()}),e8=(0,Q.forwardRef)(function(e,t){let{routerPanesState:n,groupIndex:i}=(0,Q.useContext)(e4),r=(0,Q.useMemo)(()=>n.slice(0,i),[i,n]),o=(0,Q.useMemo)(()=>({panes:r}),[r]);return(0,Y.jsx)(eg.Px,{...e,ref:t,state:o})}),e9=(0,Q.forwardRef)(function(e,t){let{childId:n,childPayload:i,childParameters:r,...o}=e,{routerPanesState:l,groupIndex:s}=(0,Q.useContext)(e4);return(0,Y.jsx)(eg.Px,{...o,ref:t,state:{panes:[...l.slice(0,s+1),[{id:n,params:r,payload:i}]]}})}),e6=(0,Q.forwardRef)(function(e,t){let{documentId:n,documentType:i,parentRefPath:r,children:o,template:l,...s}=e;return(0,Y.jsx)(e9,{...s,ref:t,childId:n,childPayload:null==l?void 0:l.params,childParameters:{type:i,parentRefPath:(0,eb.BB)(r),...l&&{template:null==l?void 0:l.id}},children:o})}),e7=(0,Q.forwardRef)(function(e,t){let{routerPanesState:n,groupIndex:i,siblingIndex:r}=(0,Q.useContext)(e4),{params:o,payload:l,...s}=e,a=(0,G.BoV)(o),c=(0,G.BoV)(l),d=(0,Q.useMemo)(()=>{let e=n[i],t=e[r],o={...t,params:null!=a?a:t.params,payload:null!=c?c:t.payload},l=[...e.slice(0,r),o,...e.slice(r+1)],s=[...n.slice(0,i),l,...n.slice(i+1)];return{panes:s}},[n,i,a,c,r]);return(0,Y.jsx)(eg.Px,{ref:t,...s,state:d})});function te(){return(0,Q.useContext)(e4)}let tt=[];function tn(e){let{onClick:t,type:n,value:i}=e,r=(0,G.vsM)(null==i?void 0:i._id),o=(0,G.Dqo)(r),l=(0,G.rq_)(),{ReferenceChildLink:s}=te(),a=(0,Q.useCallback)(function(e){return(0,Y.jsx)(s,{documentId:null==i?void 0:i._id,documentType:null==n?void 0:n.name,parentRefPath:tt,...e})},[s,null==n?void 0:n.name,null==i?void 0:i._id]);return(0,Y.jsx)(G.oUE,{__unstable_focusRing:!0,as:a,"data-as":"a",onClick:t,padding:2,radius:2,children:(0,Y.jsx)(e3,{documentPreviewStore:l,icon:null==n?void 0:n.icon,layout:"default",presence:(null==o?void 0:o.length)>0?o:tt,schemaType:n,value:i})})}var ti=Object.freeze,tr=Object.defineProperty,to=(e,t)=>ti(tr(e,"raw",{value:ti(t||e.slice())}));let tl=(0,X.ZP)(W.xu)(h||(h=to(["\n  margin-left: auto;\n"]))),ts=X.ZP.details(m||(m=to(["\n  flex: none;\n\n  &[open] "," {\n    transform: rotate(180deg);\n  }\n"])),tl),ta=X.ZP.summary(f||(f=to(["\n  list-style: none;\n\n  &::-webkit-details-marker {\n    display: none;\n  }\n"]))),tc=X.ZP.table(x||(x=to(["\n  width: 100%;\n  text-align: left;\n  padding: 0 ",";\n  border-collapse: collapse;\n\n  th {\n    padding: ",";\n  }\n\n  td {\n    padding: 0 ",";\n  }\n\n  tr > *:last-child {\n    text-align: right;\n  }\n"])),e=>{let{theme:t}=e;return(0,W.hO)(t.sanity.space[2])},e=>{let{theme:t}=e;return(0,W.hO)(t.sanity.space[1])},e=>{let{theme:t}=e;return(0,W.hO)(t.sanity.space[1])}),td=(0,X.ZP)(W.kC)(g||(g=to(["\n  min-height: 35px;\n"]))),tu=e=>{let t=e.totalCount-e.references.length;return t?(0,Y.jsxs)(W.gF,{space:2,children:[(0,Y.jsxs)(W.xv,{size:1,muted:!0,children:[t," other reference",1===t?"":"s"," not shown"," "]}),(0,Y.jsx)(W.u,{portal:!0,placement:"top",content:(0,Y.jsx)(W.W2,{width:0,children:(0,Y.jsx)(W.xu,{padding:2,children:(0,Y.jsx)(W.xv,{size:1,children:"We can't show metadata about these references because no token with access to the datasets they are in was found."})})}),children:(0,Y.jsx)(W.xv,{size:1,muted:!0,children:(0,Y.jsx)($.hQ6,{})})})]}):null};function tp(e){let{crossDatasetReferences:t,internalReferences:n,documentTitle:i,totalCount:r,action:o,datasetNames:l,hasUnknownDatasetNames:s,onReferenceLinkClick:a}=e,c=(0,G.I_y)(),d=(0,W.pm)(),u=(0,Q.useCallback)(e=>{let t=c.get(e._type);return t?(0,Y.jsx)(tn,{type:t,value:e,onClick:a}):(0,Y.jsx)(W.xu,{padding:2,children:(0,Y.jsx)(G.ogX,{icon:$.Tzq,title:"Preview Unavailable",subtitle:"ID: ".concat(e._id),layout:"default"})})},[c,a]);if((null==n?void 0:n.totalCount)===0&&(null==t?void 0:t.totalCount)===0)return(0,Y.jsxs)(W.xv,{as:"p",children:["Are you sure you want to ",o," ",(0,Y.jsxs)("strong",{children:["“",i,"”"]}),"?"]});let p=1===t.totalCount?"1 document":"".concat(t.totalCount.toLocaleString()," documents"),h=[...l,...s?["unavailable"]:[]],m=1===h.length?"another dataset":"".concat(h.length," datasets"),f="Dataset".concat(1===h.length?"":"s",": ").concat(h.join(", "));return s&&1===h.length&&(f="Unavailable dataset"),(0,Y.jsxs)(W.Zb,{children:[(0,Y.jsx)(W.Zb,{padding:3,radius:2,tone:"caution",marginBottom:4,flex:"none",children:(0,Y.jsxs)(W.kC,{children:[(0,Y.jsx)(W.xv,{"aria-hidden":"true",size:1,children:(0,Y.jsx)($.foC,{})}),(0,Y.jsx)(W.xu,{flex:1,marginLeft:3,children:(0,Y.jsx)(W.xv,{size:1,children:1===r?(0,Y.jsxs)(Y.Fragment,{children:["1 document refers to “",i,"”"]}):(0,Y.jsxs)(Y.Fragment,{children:[r.toLocaleString()," documents refer to “",i,"”"]})})})]})}),(0,Y.jsx)(W.xu,{flex:"none",marginBottom:4,children:(0,Y.jsxs)(W.xv,{children:["You may not be able to ",o," “",i,"” because the following documents refer to it:"]})}),(0,Y.jsx)(W.Zb,{radius:2,shadow:1,marginBottom:4,flex:"auto",children:(0,Y.jsxs)(W.kC,{direction:"column",children:[n.totalCount>0&&(0,Y.jsxs)(W.Kq,{as:"ul",padding:2,space:3,"data-testid":"internal-references",children:[null==n?void 0:n.references.map(e=>(0,Y.jsx)(W.xu,{as:"li",children:u(e)},e._id)),n.totalCount>n.references.length&&(0,Y.jsx)(W.xu,{as:"li",padding:3,children:(0,Y.jsx)(tu,{...n})})]}),t.totalCount>0&&(0,Y.jsxs)(ts,{"data-testid":"cross-dataset-references",style:{borderTop:n.totalCount>0?"1px solid var(--card-shadow-outline-color)":void 0},children:[(0,Y.jsx)(ta,{children:(0,Y.jsx)(W.Zb,{as:"a",margin:2,radius:2,shadow:1,paddingY:1,children:(0,Y.jsxs)(W.kC,{align:"center",margin:2,children:[(0,Y.jsx)(W.xu,{marginLeft:3,marginRight:4,children:(0,Y.jsx)(W.xv,{size:3,children:(0,Y.jsx)($.TAM,{})})}),(0,Y.jsxs)(W.kC,{marginRight:4,direction:"column",children:[(0,Y.jsx)(W.xu,{marginBottom:2,children:(0,Y.jsxs)(W.xv,{children:[p," in ",m]})}),(0,Y.jsx)(W.xu,{children:(0,Y.jsx)(W.xv,{title:f,textOverflow:"ellipsis",size:1,muted:!0,children:f})})]}),(0,Y.jsx)(tl,{children:(0,Y.jsx)(W.xv,{muted:!0,children:(0,Y.jsx)($.v4q,{})})})]})})}),(0,Y.jsxs)(W.xu,{overflow:"auto",paddingBottom:2,paddingX:2,children:[(0,Y.jsxs)(tc,{children:[(0,Y.jsx)("thead",{children:(0,Y.jsxs)("tr",{children:[(0,Y.jsx)("th",{children:(0,Y.jsx)(W.__,{muted:!0,size:0,style:{minWidth:"5rem"},children:"Project ID"})}),(0,Y.jsx)("th",{children:(0,Y.jsx)(W.__,{muted:!0,size:0,children:"Dataset"})}),(0,Y.jsx)("th",{children:(0,Y.jsx)(W.__,{muted:!0,size:0,children:"Document ID"})})]})}),(0,Y.jsx)("tbody",{children:t.references.filter(e=>"projectId"in e).map((e,t)=>{let{projectId:n,datasetName:i,documentId:r}=e;return(0,Y.jsxs)("tr",{children:[(0,Y.jsx)("td",{children:(0,Y.jsx)(W.xv,{size:1,children:n})}),(0,Y.jsx)("td",{children:(0,Y.jsx)(W.xv,{size:1,children:i||"unavailable"})}),(0,Y.jsx)("td",{children:(0,Y.jsxs)(td,{align:"center",gap:2,justify:"flex-end",children:[(0,Y.jsx)(W.xv,{textOverflow:"ellipsis",size:1,children:r||"unavailable"}),r&&(0,Y.jsx)(eu(),{text:r,onCopy:()=>{d.push({title:"Copied document ID to clipboard!",status:"success"})},children:(0,Y.jsx)(W.zx,{title:"Copy ID to clipboard",mode:"bleed",icon:$.Kmg,fontSize:0})})]})})]},"".concat(r,"-").concat(t))})})]}),(0,Y.jsx)(W.xu,{padding:2,children:(0,Y.jsx)(tu,{...t})})]})]})]})}),(0,Y.jsx)(W.xu,{flex:"none",children:(0,Y.jsxs)(W.xv,{children:["If you ",o," this document, documents that refer to it will no longer be able to access it."]})})]})}var th=Object.freeze,tm=Object.defineProperty,tf=(e,t)=>th(tm(e,"raw",{value:th(t||e.slice())}));let tx=(0,X.ZP)(W.xu).attrs({padding:4})(y||(y=tf(["\n  box-sizing: border-box;\n"]))),tg=(0,X.ZP)(W.kC).attrs({align:"center",direction:"column",justify:"center"})(v||(v=tf(["\n  height: 300px;\n"])));function ty(e){let{id:t,type:n,action:i="delete",onCancel:r,onConfirm:o}=e,l="deletion-confirmation-".concat((0,Q.useId)()),{internalReferences:s,crossDatasetReferences:a,isLoading:c,totalCount:d,projectIds:u,datasetNames:p,hasUnknownDatasetNames:h}=function(e){let t=(0,G.m85)(G.Dr7),n=(0,G.H__)(),i=(0,G.vsM)(e),[r,o]=eK((0,Q.useMemo)(()=>[i,n],[n,i])),[l,s]=e0((0,Q.useMemo)(()=>[i,t],[i,t])),a=(0,Q.useMemo)(()=>Array.from(new Set(null==l?void 0:l.references.map(e=>e.projectId).filter(Boolean))).sort(),[null==l?void 0:l.references]),c=(0,Q.useMemo)(()=>Array.from(new Set(null==l?void 0:l.references.map(e=>(null==e?void 0:e.datasetName)||"").filter(e=>!!e&&""!==e))).sort(),[null==l?void 0:l.references]),d=(0,Q.useMemo)(()=>!!(null==l?void 0:l.references.some(e=>"string"!=typeof e.datasetName)),[null==l?void 0:l.references]);return{totalCount:((null==r?void 0:r.totalCount)||0)+((null==l?void 0:l.totalCount)||0),projectIds:a,datasetNames:c,hasUnknownDatasetNames:d,internalReferences:r,crossDatasetReferences:l,isLoading:o||s}}(t),m="".concat(i.substring(0,1).toUpperCase()).concat(i.substring(1)),f=(0,Y.jsx)(eW,{document:(0,Q.useMemo)(()=>({_id:t,_type:n}),[t,n])}),x=!c;return(0,Y.jsx)(W.Vq,{width:1,id:l,header:"".concat(m," document?"),footer:(0,Y.jsxs)(W.rj,{columns:x?2:1,gap:2,paddingX:4,paddingY:3,children:[(0,Y.jsx)(W.zx,{mode:"ghost",onClick:r,text:"Cancel"}),x&&(0,Y.jsx)(W.zx,{"data-testid":"confirm-delete-button",text:d>0?"".concat(m," anyway"):"".concat(m," now"),tone:"critical",onClick:o})]}),onClose:r,onClickOutside:r,children:(0,Y.jsx)(tx,{children:a&&s&&!c?(0,Y.jsx)(tp,{crossDatasetReferences:a,internalReferences:s,documentTitle:f,isLoading:c,totalCount:d,action:i,projectIds:u,datasetNames:p,hasUnknownDatasetNames:h,onReferenceLinkClick:r}):(0,Y.jsxs)(tg,{"data-testid":"loading-container",children:[(0,Y.jsx)(W.$j,{muted:!0}),(0,Y.jsx)(W.xu,{marginTop:3,children:(0,Y.jsx)(W.xv,{align:"center",muted:!0,size:1,children:"Looking for referring documents…"})})]})})})}function tv(e){let t=(0,Q.useId)(),[n,i]=(0,Q.useState)(null),r=(0,Q.useCallback)(()=>i(null),[]);return n?(0,Y.jsx)(W.Vq,{id:"dialog-error-".concat(t),"data-testid":"confirm-delete-error-dialog",header:"Error",footer:(0,Y.jsx)(W.kC,{paddingX:4,paddingY:3,direction:"column",children:(0,Y.jsx)(W.zx,{mode:"ghost",text:"Retry",onClick:r})}),onClose:e.onCancel,children:(0,Y.jsx)(W.xu,{padding:4,children:(0,Y.jsx)(W.xv,{children:"An error occurred while loading referencing documents."})})}):(0,Y.jsx)(W.SV,{onCatch:i,children:(0,Y.jsx)(ty,{...e})})}let tb={constrainSize:!0,placement:"left-start",portal:!0};function tj(e){let{disabled:t,isAfterGroup:n,node:i}=e;return"divider"===i.type?(0,Y.jsx)(W.R,{}):"group"===i.type?0===i.children.length?null:i.expanded?(0,Y.jsxs)(Y.Fragment,{children:[n&&(0,Y.jsx)(W.R,{}),i.title&&(0,Y.jsx)(W.xu,{padding:2,paddingBottom:1,children:(0,Y.jsx)(W.__,{muted:!0,size:0,children:i.title})}),i.children.map((e,n)=>{var r;return(0,Y.jsx)(tj,{disabled:t||!!i.disabled,isAfterGroup:(null==(r=i.children[n-1])?void 0:r.type)==="group",node:e},e.key)})]}):(0,Y.jsxs)(Y.Fragment,{children:[n&&(0,Y.jsx)(W.R,{}),(0,Y.jsx)(W.kS,{disabled:t,icon:i.icon,popover:tb,text:i.title,children:i.children.map((e,n)=>{var r;return(0,Y.jsx)(tj,{disabled:t||!!i.disabled,isAfterGroup:(null==(r=i.children[n-1])?void 0:r.type)==="group",node:e},e.key)})})]}):(0,Y.jsxs)(Y.Fragment,{children:[n&&(0,Y.jsx)(W.R,{}),(0,Y.jsx)(tw,{disabled:t,node:i})]})}function tw(e){let{node:t}=e;return t.intent?(0,Y.jsx)(tC,{...e,intent:t.intent}):(0,Y.jsx)(tI,{...e})}function tI(e){var t;let{disabled:n,node:i}=e,r="object"==typeof i.disabled&&(0,Y.jsx)(W.xv,{size:1,children:i.disabled.reason});return(0,Y.jsx)(G.xMr,{content:r,placement:"left",children:(0,Y.jsx)(W.sN,{disabled:n||!!i.disabled,hotkeys:null==(t=i.hotkey)?void 0:t.split("+"),icon:i.icon,iconRight:i.iconRight||i.selected&&$.KML,onClick:i.onAction,pressed:i.selected,text:i.title,tone:i.tone})})}function tC(e){var t;let{disabled:n,intent:i,node:r}=e,o="object"==typeof r.disabled&&(0,Y.jsx)(W.xv,{size:1,children:r.disabled.reason}),l=(0,eg.PM)({intent:i.type,params:i.params}),s=(0,Q.useCallback)(e=>{l.onClick(e),r.onAction()},[l,r]);return(0,Y.jsx)(G.xMr,{content:o,placement:"left",children:(0,Y.jsx)(W.sN,{as:"a",disabled:n||!!r.disabled,hotkeys:null==(t=r.hotkey)?void 0:t.split("+"),href:l.href,icon:r.icon,iconRight:r.selected?$.KML:void 0,onClick:s,pressed:r.selected,text:r.title,tone:r.tone})})}let t_={constrainSize:!0,placement:"bottom",portal:!0};function tT(e,t){return e.some(e=>"item"===e.type&&e.tone===t||"group"===e.type&&tT(e.children,t))}function tk(e){let{nodes:t}=e,n=(0,Q.useId)(),i=tT(t,"critical"),r=tT(t,"caution");return(0,Y.jsx)(W.j2,{button:(0,Y.jsx)(G.YG6,{icon:$.zGg,mode:"bleed",title:"Show menu",tone:i?"critical":r?"caution":void 0}),id:n,menu:(0,Y.jsx)(W.v2,{children:t.map((e,n)=>{var i;let r=(null==(i=t[n-1])?void 0:i.type)==="group";return(0,Y.jsx)(tj,{isAfterGroup:r,node:e},e.key)})}),popover:t_})}let tE=51,tP=4*tE,tA=(0,Q.createContext)(null),tD=(0,Q.createContext)(null);function tS(){let e=(0,Q.useContext)(tD);if(!e)throw Error("PaneLayout: missing context value");return e}var tR=Object.freeze,tO=Object.defineProperty;let tz=(0,X.ZP)(W.mh)(b||(b=tR(tO(r=["\n  position: relative;\n  width: 1px;\n  min-width: 1px;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    width: 1px;\n    background-color: var(--card-border-color);\n  }\n\n  &:not([data-disabled]) {\n    cursor: ew-resize;\n    width: 9px;\n    min-width: 9px;\n    margin: 0 -4px;\n\n    &:before {\n      left: 4px;\n    }\n\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 9px;\n      bottom: 0;\n      background-color: var(--card-border-color);\n      opacity: 0;\n      transition: opacity 150ms;\n    }\n\n    &[data-dragging]:after,\n    &:hover:after {\n      opacity: 0.2;\n    }\n  }\n"],"raw",{value:tR(r.slice())}))));function tM(e){let{disabled:t,element:n}=e,{resize:i}=tS(),[r,o]=(0,Q.useState)(!1),l=(0,Q.useCallback)(e=>{if(!n)return;o(!0),e.preventDefault();let t=e.pageX;i("start",n,0);let r=e=>{e.preventDefault();let r=e.pageX-t;i("move",n,r)},l=e=>{e.preventDefault(),o(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",l),i("end",n,0)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",l)},[n,i]);return(0,Y.jsx)(tz,{"data-disabled":t?"":void 0,"data-dragging":r?"":void 0,onMouseDown:l})}var tL=Object.freeze,tU=Object.defineProperty;let tN=(0,X.ZP)(W.Zb)(j||(j=tL(tU(o=["\n  outline: none;\n\n  // NOTE: This will render a border to the right side of each pane\n  // without taking up physical space.\n  box-shadow: 1px 0 0 var(--card-border-color);\n"],"raw",{value:tL(o.slice())})))),tH=(0,Q.forwardRef)(function(e,t){var n,i,r;let{children:o,currentMinWidth:l,currentMaxWidth:s,flex:a=1,id:c,minWidth:d,maxWidth:u,selected:p=!1,...h}=e,[m,f]=(0,Q.useState)(null),{collapse:x,collapsed:g,expand:y,expandedElement:v,mount:b,panes:j}=tS(),w=j.find(e=>e.element===m),I=w&&j.indexOf(w),C="number"==typeof I?j[I+1]:void 0,_=I===j.length-1,T=!g&&((null==w?void 0:w.collapsed)||!1),k=(null==C?void 0:C.collapsed)||!1,E=(0,W.ts)(t),P=null!=(n=null==w?void 0:w.flex)?n:a,A=null!=(i=null==w?void 0:w.currentMinWidth)?i:l,D=null!=(r=null==w?void 0:w.currentMaxWidth)?r:s,S=(0,Q.useCallback)(e=>{f(e),E.current=e},[E]);(0,Q.useEffect)(()=>{if(m)return b(m,{currentMinWidth:l,currentMaxWidth:s,flex:a,id:c,minWidth:d,maxWidth:u})},[l,s,a,c,d,u,b,m]);let R=(0,Q.useCallback)(()=>{m&&x(m)},[x,m]),O=(0,Q.useCallback)(()=>{m&&y(m)},[y,m]),z=(0,Q.useMemo)(()=>({collapse:R,collapsed:!g&&T,expand:O,index:I,isLast:_,rootElement:m}),[T,R,O,_,g,I,m]),M=(0,Q.useMemo)(()=>g?void 0:T?tE:0===A||_?d||tP:A||d||tP,[T,A,_,g,d]),L=(0,Q.useMemo)(()=>T?tE:g&&_?void 0:_?u?null!=D?D:u:void 0:null!=D?D:u,[T,D,_,g,u]),U=g&&!_,N=(0,Q.useMemo)(()=>!_&&!g&&(0,Y.jsx)(G.jr5,{zOffset:"paneResizer",children:(0,Y.jsx)(tM,{disabled:T||k,element:m})}),[T,_,g,k,m]),H=(0,Q.useMemo)(()=>({flex:P,minWidth:M,maxWidth:L===1/0?void 0:L}),[P,M,L]);return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(G.jr5,{zOffset:"pane",children:(0,Y.jsx)(tA.Provider,{value:z,children:(0,Y.jsxs)(tN,{"data-testid":"pane","data-ui":"Pane",tone:"inherit",hidden:U,id:c,overflow:g?void 0:"hidden",...h,"data-pane-collapsed":T?"":void 0,"data-pane-index":I,"data-pane-selected":p?"":void 0,ref:S,style:H,children:[!1,(0,Y.jsx)(W.NM,{element:m,children:!U&&(0,Y.jsx)(W.kC,{direction:"column",height:"fill",children:o})})]})})}),N]})});function tV(){let e=(0,Q.useContext)(tA);if(!e)throw Error("Pane: missing context value");return e}var tB=Object.freeze,tZ=Object.defineProperty;let tF=(0,X.ZP)(W.Zb)(w||(w=tB(tZ(l=["\n  position: relative;\n  outline: none;\n"],"raw",{value:tB(l.slice())}))));tF.displayName="PaneContent__root";let tq=(0,Q.forwardRef)(function(e,t){let{as:n,children:i,overflow:r,padding:o,...l}=e,{collapsed:s}=tV(),{collapsed:a}=tS();return(0,Y.jsx)(tF,{"data-testid":"pane-content",forwardedAs:n,...l,flex:1,hidden:s,overflow:a?void 0:r,padding:o,ref:t,tone:"inherit",children:i})});var t$=Object.freeze,tQ=Object.defineProperty,tY=(e,t)=>t$(tQ(e,"raw",{value:t$(t||e.slice())}));let tG=(0,X.ZP)(W.mh)(I||(I=tY(["\n  position: sticky;\n  bottom: 0;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n"]))),tW=(0,X.ZP)(W.Zb)(C||(C=tY(["\n  padding-bottom: env(safe-area-inset-bottom);\n"]))),tX=(0,Q.forwardRef)(function(e,t){let{children:n,padding:i}=e,{collapsed:r}=tV();return(0,Y.jsx)(G.jr5,{zOffset:"paneFooter",children:(0,Y.jsx)(tG,{"data-testid":"pane-footer",hidden:r,ref:t,children:(0,Y.jsx)(tW,{tone:"inherit",children:(0,Y.jsx)(W.xu,{padding:i,children:n})})})})});var tJ=Object.freeze,tK=Object.defineProperty,t0=(e,t)=>tJ(tK(e,"raw",{value:tJ(t||e.slice())}));let t1=(0,X.ZP)(W.mh)(_||(_=t0(["\n  line-height: 0;\n  position: sticky;\n  top: 0;\n\n  &:not([data-collapsed]):after {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n"]))),t2=(0,X.ZP)(W.kC)(T||(T=t0(["\n  transform-origin: calc(51px / 2);\n\n  [data-collapsed] > div > & {\n    transform: rotate(90deg);\n  }\n"]))),t3=(0,X.ZP)(W.Zb)(e=>{let{theme:t}=e,{fg:n,bg:i}=t.sanity.color.card.enabled;return(0,X.iv)(k||(k=t0(["\n    background-color: ",";\n\n    [data-ui='Text'] {\n      color: ",";\n    }\n  "])),i,n)}),t5=(0,X.ZP)(W.Qr)(E||(E=t0(["\n  width: 66%;\n  max-width: 175px;\n"]))),t4=(0,X.ZP)(W.xv)(P||(P=t0(["\n  cursor: default;\n  outline: none;\n"]))),t8=(0,X.ZP)(W.xu)(e=>{let{theme:t}=e,{color:n,space:i}=t.sanity;return(0,X.iv)(A||(A=t0(["\n    overflow: hidden;\n    overflow: clip;\n    position: relative;\n\n    & > div {\n      white-space: nowrap;\n      overflow: auto;\n      /* Hide scrollbars */\n      scrollbar-width: none;\n      &::-webkit-scrollbar {\n        width: 0;\n        height: 0;\n      }\n    }\n\n    /* right padding */\n    & > div:after {\n      content: '';\n      display: inline-block;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      width: ","px;\n      height: 1px;\n    }\n\n    /* Gradient that makes it look like tabs disappear into nothing (looks nicer) */\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      background: linear-gradient(to right, ",", var(--card-bg-color));\n      width: ","px;\n      pointer-events: none;\n    }\n  "])),i[3],(0,W.m4)(n.base.bg,0),i[3])}),t9=(0,Q.forwardRef)(function(e,t){let{actions:n,backButton:i,contentAfter:r,loading:o,subActions:l,tabs:s,tabIndex:a,title:c}=e,{collapse:d,collapsed:u,expand:p,rootElement:h}=tV(),m=(0,W.XL)(h||null),f=(0,Q.useMemo)(()=>({width:u?(null==m?void 0:m.height)||window.innerHeight:void 0}),[u,m]),x=(0,Q.useCallback)(()=>{u||d()},[d,u]),g=(0,Q.useCallback)(()=>{u&&p()},[u,p]),y=!!(!u&&(s||l));return(0,Y.jsx)(W.li,{zOffset:100,children:(0,Y.jsx)(t1,{"data-collapsed":u?"":void 0,"data-testid":"pane-header",ref:t,children:(0,Y.jsx)(G.jr5,{zOffset:"paneHeader",children:(0,Y.jsxs)(W.Zb,{"data-collapsed":u?"":void 0,tone:"inherit",children:[(0,Y.jsxs)(t2,{onClick:g,padding:2,sizing:"border",style:f,children:[i&&(0,Y.jsx)(W.xu,{flex:"none",padding:1,children:i}),(0,Y.jsxs)(t3,{__unstable_focusRing:!0,flex:1,forwardedAs:"button",marginRight:n?1:0,onClick:x,paddingLeft:i?1:3,paddingY:3,tabIndex:a,children:[o&&(0,Y.jsx)(t5,{animated:!0,radius:1}),!o&&(0,Y.jsx)(t4,{textOverflow:"ellipsis",weight:"semibold",children:c})]}),n&&(0,Y.jsx)(W.xu,{flex:"none",hidden:u,children:(0,Y.jsx)(G.jr5,{zOffset:"paneHeader",children:n})})]}),y&&(0,Y.jsxs)(W.kC,{align:"center",hidden:u,overflow:"auto",paddingBottom:3,paddingX:3,paddingTop:1,children:[(0,Y.jsx)(t8,{flex:1,marginRight:l?3:0,children:s}),l&&l]}),!u&&r&&r]})})})})});function t6(e){let{node:t,padding:n}=e;return"item"===t.type?(0,Y.jsx)(t7,{node:t,padding:n}):"group"===t.type?(0,Y.jsx)(nt,{node:t,padding:n}):(console.warn('unknown menu node (expected `type: "item" | "group"`):',t),null)}function t7(e){var t;let{node:n,padding:i}=e;if(n.intent)return(0,Y.jsx)(ne,{...e,intent:n.intent});let r="object"==typeof n.disabled&&(0,Y.jsx)(W.xv,{size:1,children:n.disabled.reason});return(0,Y.jsx)(G.xMr,{content:r,placement:"bottom",children:(0,Y.jsx)(G.YG6,{disabled:!!n.disabled,hotkey:null==(t=n.hotkey)?void 0:t.split("+"),icon:n.icon,label:r?void 0:n.title,onClick:n.onAction,padding:i,selected:n.selected,tone:n.tone})})}function ne(e){var t;let{intent:n,node:i,padding:r}=e,o="object"==typeof i.disabled&&(0,Y.jsx)(W.xv,{size:1,children:i.disabled.reason}),l=(0,eg.PM)({intent:n.type,params:n.params}),s=(0,Q.useCallback)(e=>{l.onClick(e),i.onAction()},[l,i]);return(0,Y.jsx)(G.xMr,{content:o,placement:"bottom",children:(0,Y.jsx)(G.YG6,{as:"a",disabled:!!i.disabled,hotkey:null==(t=i.hotkey)?void 0:t.split("+"),href:l.href,icon:i.icon,label:o?void 0:i.title,onClick:s,padding:r,selected:i.selected,tone:i.tone})})}function nt(e){var t;let{node:n,padding:i}=e;return(0,Y.jsx)(W.j2,{button:(0,Y.jsx)(G.YG6,{disabled:n.disabled,icon:null!=(t=n.icon)?t:$.Tzq,label:n.title,padding:i}),id:(0,Q.useId)(),menu:(0,Y.jsx)(W.v2,{children:n.children.map((e,t)=>{var i;return(0,Y.jsx)(tj,{disabled:!!n.disabled,isAfterGroup:(null==(i=n.children[t-1])?void 0:i.type)==="group",node:e},e.key)})})})}var nn=Object.freeze,ni=Object.defineProperty;let nr=(0,X.ZP)(W.Zb)(D||(D=nn(ni(s=["\n  transition: opacity 200ms;\n  position: relative;\n  z-index: 1;\n  padding-left: env(safe-area-inset-left);\n  padding-right: env(safe-area-inset-right);\n  opacity: 0;\n\n  &:not([hidden]) {\n    display: flex;\n  }\n\n  &:not([data-collapsed]) {\n    overflow: auto;\n  }\n\n  &[data-mounted] {\n    opacity: 1;\n  }\n\n  &[data-resizing] {\n    pointer-events: none;\n  }\n"],"raw",{value:nn(s.slice())}))));function no(e){return("item"===e.type||"group"===e.type)&&e.renderAsButton}let nl=eC()(no);function ns(e){var t,n;let{fieldActions:i=[],menuItems:r,menuItemGroups:o}=e,l=[],s=0;for(let e=0;e<i.length;e+=1){let t=i[e];l.push(function e(t,n){var i,r,o;return"divider"===t.type?{type:"divider",key:n}:"group"===t.type?{type:"group",key:n,children:t.children.map((t,i)=>e(t,"".concat(n,"-").concat(i,"-").concat(t.type))),disabled:t.disabled,expanded:null==(i=t.expanded)||i,icon:t.icon,title:t.title,renderAsButton:null!=(r=t.renderAsButton)&&r}:{type:"item",key:n,disabled:t.disabled,icon:t.icon,iconRight:t.iconRight,onAction:t.onAction,renderAsButton:null!=(o=t.renderAsButton)&&o,selected:t.selected,title:t.title,tone:t.tone}}(t,"".concat(e,"-").concat(t.type)))}s+=l.length;let a=[];for(let e of o){let t=a.find(t=>t.key===e.id);t||a.push({type:"group",key:e.id,children:[],expanded:!0,renderAsButton:!1,title:e.title})}let c=[];for(let i=0;i<r.length;i+=1){let o=r[i],l=o.group&&a.find(e=>e.key===o.group);o.group&&!l&&(l={type:"group",key:o.group,expanded:!0,icon:o.icon,title:o.group,children:[],renderAsButton:!1},a.push(l)),l?l.children.push({type:"item",key:"".concat(s+i,"-item"),hotkey:o.shortcut,icon:o.icon,onAction:()=>e.actionHandler(o),renderAsButton:null!=(t=o.showAsAction)&&t,selected:o.selected,title:o.title,tone:o.tone}):c.push({type:"item",key:"".concat(s+i,"-item"),hotkey:o.shortcut,icon:o.icon,onAction:()=>e.actionHandler(o),renderAsButton:null!=(n=o.showAsAction)&&n,selected:o.selected,title:o.title,tone:o.tone})}return[...c,...a,...l]}let na=(0,Q.forwardRef)(function(e,t){let{intent:n,...i}=e,r=(0,Q.useMemo)(()=>(0,Q.forwardRef)(function(e,t){return(0,Y.jsx)(eg.nR,{...e,intent:n.type,params:n.params,ref:t})}),[n]);return e.disabled?(0,Y.jsx)(W.zx,{...e,as:"a",role:"link","aria-disabled":"true"}):(0,Y.jsx)(W.zx,{...i,as:r,"data-as":"a",ref:t})});function nc(e){let{reveal:t,loading:n,children:i}=e,r=(0,G.xJ)();return t?(0,Y.jsx)(W.u,{content:n?(0,Y.jsx)(W.xu,{padding:2,children:(0,Y.jsx)(W.xv,{children:"Loading…"})}):(0,Y.jsx)(G.FMn,{currentUser:r}),portal:!0,children:(0,Y.jsx)("div",{children:i})}):(0,Y.jsx)(Y.Fragment,{children:i})}let nd={constrainSize:!0,placement:"bottom",portal:!0},nu=(e,t,n)=>{var i;let r=null==(i=t.find(e=>e.id===n.templateId))?void 0:i.schemaType;if(!r)return null;let o={template:n.templateId,type:r,id:n.initialDocumentId};return{type:"create",params:n.parameters?[o,n.parameters]:o}};function np(e){let{templateItems:t}=e,n=(0,G.I_y)(),i=(0,G.zEW)(),[r,o]=(0,G.UMU)({templateItems:t}),l=(0,Q.useMemo)(()=>!o&&(null==r?void 0:r.every(e=>!e.granted)),[o,r]),s=(0,Q.useMemo)(()=>r?r.reduce((e,t)=>(e[t.id]=t,e),{}):{},[r]);if(l)return(0,Y.jsx)(nc,{reveal:!0,loading:o,children:(0,Y.jsx)(W.zx,{"aria-label":"Insufficient permissions",icon:$.j29,mode:"bleed",disabled:!0,"data-testid":"action-intent-button"})});if(1===t.length){let e=t[0],r=s[e.id],l=!(null==r?void 0:r.granted),a=nu(n,i,e);return a?(0,Y.jsx)(nc,{reveal:l,loading:o,children:(0,Y.jsx)(na,{"aria-label":e.title,icon:e.icon||$.j29,intent:a,mode:"bleed",disabled:l,"data-testid":"action-intent-button"})}):null}return(0,Y.jsx)(W.j2,{button:(0,Y.jsx)(W.zx,{icon:$.j29,mode:"bleed","data-testid":"multi-action-intent-button"}),id:"create-menu",menu:(0,Y.jsxs)(W.v2,{children:[(0,Y.jsx)(W.xu,{paddingX:3,paddingTop:3,paddingBottom:2,children:(0,Y.jsx)(W.__,{muted:!0,children:"Create"})}),t.map((e,t)=>{let r=s[e.id],l=!(null==r?void 0:r.granted),a=nu(n,i,e),c=i.find(t=>t.id===e.templateId);if(!c||!a)return null;let d=(0,Q.forwardRef)((e,t)=>l?(0,Y.jsx)("button",{type:"button",disabled:!0,...e,ref:t}):(0,Y.jsx)(eg.nR,{...e,intent:a.type,params:a.params,ref:t}));return d.displayName="Link",(0,Y.jsx)(nc,{reveal:l,loading:o,children:(0,Y.jsx)(W.sN,{as:d,"data-as":l?"button":"a",text:e.title||c.title,"aria-label":l?"Insufficient permissions":e.title||c.title,disabled:l,"data-testid":"action-intent-button-".concat(t)})},e.id)})]}),popover:nd})}function nh(e){return null!=e}let nm=e=>{let t=e=>"object"==typeof e&&e?Array.isArray(e)?e.map(t):Object.entries(e).sort((e,t)=>{let[n]=e,[i]=t;return n.localeCompare(i,"en")}):e;return JSON.stringify(t(JSON.parse(JSON.stringify(e))))},nf=(0,Q.memo)(function(e){let{initialValueTemplateItems:t=G.LZ8,menuItems:n=G.LZ8,menuItemGroups:i=G.LZ8,actionHandlers:r=G.NuZ}=e,o=(0,G.zEW)(),l=(0,Q.useCallback)(e=>{if("string"==typeof e.action&&!(e.action in r))return console.warn("No handler for action:",e.action),!1;let t="function"==typeof e.action?e.action:"string"==typeof e.action?r[e.action]:null;return!!t&&(t(e.params),!0)},[r]),s=(0,Q.useMemo)(()=>ns({actionHandler:l,menuItemGroups:i,menuItems:n.filter(e=>{var t;return(null==(t=e.intent)?void 0:t.type)!=="create"})}),[l,i,n]),a=(0,Q.useMemo)(()=>s.filter(no),[s]),c=(0,Q.useMemo)(()=>s.filter(nl),[s]),d=(0,Q.useMemo)(()=>n.map((e,t)=>{var n;if((null==(n=e.intent)?void 0:n.type)!=="create")return null;let{params:i}=e.intent;if(!i)return null;let r=Array.isArray(i)?i[0]:i,l=Array.isArray(i)?i[1]:void 0,s=r.template||r.type;if(!s)return null;let a=o.find(e=>e.id===s);if(!a)return null;let c=r.id;return{item:e,template:a,templateParams:l,menuItemIndex:t,initialDocumentId:c}}).filter(nh).map(e=>{let{initialDocumentId:t,item:n,template:i,menuItemIndex:r,templateParams:o}=e,l={id:"menuItem".concat(r),initialDocumentId:t,templateId:i.id,type:"initialValueTemplateItem",title:n.title||i.title,icon:n.icon,description:i.description,parameters:o,schemaType:i.schemaType};return l}),[n,o]),u=(0,Q.useMemo)(()=>ew()([...d,...t],e=>nm([e.initialDocumentId,e.templateId,e.parameters])),[d,t]);return(0,Y.jsxs)(W.kC,{gap:1,children:[u.length>0&&(0,Y.jsx)(np,{templateItems:u}),a.map(e=>(0,Y.jsx)(t6,{node:e},e.key)),c.length>0&&(0,Y.jsx)(tk,{nodes:c})]})}),nx={NOTHING_TO_DELETE:"This document doesn’t yet exist or is already deleted"},ng=e=>{let{id:t,type:n,draft:i,onComplete:r}=e,{delete:o}=(0,G.d9t)(t,n),[l,s]=(0,Q.useState)(!1),[a,c]=(0,Q.useState)(!1),d=(0,Q.useCallback)(()=>{c(!1),r()},[r]),u=(0,Q.useCallback)(()=>{s(!0),c(!1),o.execute(),r()},[o,r]),p=(0,Q.useCallback)(()=>{c(!0)},[]),[h,m]=(0,G.hHf)({id:t,type:n,permission:"delete"}),f=(0,G.xJ)();return m||(null==h?void 0:h.granted)?{tone:"critical",icon:$.XHJ,disabled:l||!!o.disabled||m,title:o.disabled&&nx[o.disabled]||"",label:l?"Deleting…":"Delete",shortcut:"Ctrl+Alt+D",onHandle:p,dialog:a&&{type:"custom",component:(0,Y.jsx)(tv,{action:"delete",id:(null==i?void 0:i._id)||t,type:n,onCancel:d,onConfirm:u})}}:{tone:"critical",icon:$.XHJ,disabled:!0,label:"Delete",title:(0,Y.jsx)(G.FMn,{operationLabel:"delete this document",currentUser:f})}};ng.action="delete";let ny={NO_CHANGES:"This document has no unpublished changes",NOT_PUBLISHED:"This document is not published"},nv=e=>{let{id:t,type:n,published:i,liveEdit:r,onComplete:o}=e,{discardChanges:l}=(0,G.d9t)(t,n),[s,a]=(0,Q.useState)(!1),[c,d]=(0,G.hHf)({id:t,type:n,permission:"discardDraft"}),u=(0,G.xJ)(),p=(0,Q.useCallback)(()=>{l.execute(),o()},[l,o]),h=(0,Q.useCallback)(()=>{a(!0)},[]),m=(0,Q.useMemo)(()=>s&&{type:"confirm",tone:"critical",onCancel:o,onConfirm:p,message:(0,Y.jsx)(Y.Fragment,{children:"Are you sure you want to discard all changes since last published?"})},[p,s,o]);return!i||r?null:d||(null==c?void 0:c.granted)?{tone:"critical",icon:$.X5P,disabled:!!l.disabled||d,title:l.disabled&&ny[l.disabled]||"",label:"Discard changes",onHandle:h,dialog:m}:{tone:"critical",icon:$.X5P,disabled:!0,label:"Discard changes",title:(0,Y.jsx)(G.FMn,{operationLabel:"discard changes in this document",currentUser:u})}};nv.action="discardChanges";let nb={NOTHING_TO_DUPLICATE:"This document doesn’t yet exist so there‘s nothing to duplicate"},nj=e=>{let{id:t,type:n,onComplete:i}=e,{duplicate:r}=(0,G.d9t)(t,n),{navigateIntent:o}=(0,eg.tv)(),[l,s]=(0,Q.useState)(!1),[a,c]=(0,G.hHf)({id:t,type:n,permission:"duplicate"}),d=(0,G.xJ)(),u=(0,Q.useCallback)(()=>{let e=(0,eT.Z)();s(!0),r.execute(e),o("edit",{id:e,type:n}),i()},[r,o,i,n]);return c||(null==a?void 0:a.granted)?{icon:$.TIy,disabled:l||!!r.disabled||c,label:l?"Duplicating…":"Duplicate",title:r.disabled&&nb[r.disabled]||"",onHandle:u}:{icon:$.TIy,disabled:!0,label:"Duplicate",title:(0,Y.jsx)(G.FMn,{operationLabel:"duplicate this document",currentUser:d})}};nj.action="duplicate";let nw=e=>{let{id:t,type:n,revision:i,onComplete:r}=e,{restore:o}=(0,G.d9t)(t,n),{navigateIntent:l}=(0,eg.tv)(),[s,a]=(0,Q.useState)(!1),c=(0,Q.useCallback)(()=>{o.execute(i),r(),setTimeout(()=>l("edit",{id:t,type:n}),0)},[o,i,l,t,n,r]),d=(0,Q.useCallback)(()=>{a(!0)},[]),u=(0,Q.useMemo)(()=>s?{type:"confirm",tone:"critical",onCancel:r,onConfirm:c,message:(0,Y.jsx)(Y.Fragment,{children:"Are you sure you want to restore this document?"})}:null,[c,s,r]),p="@initial"===i,h=void 0===i;return h?null:{label:"Restore",color:"primary",onHandle:d,title:p?"You can't restore to the initial version":"Restore to this version",icon:$.vaD,dialog:u,disabled:p}};nw.action="restore";let nI=(0,Q.createContext)(null);function nC(){let e=(0,Q.useContext)(nI);if(!e)throw Error("DocumentPane: missing context value");return e}let n_={LIVE_EDIT_ENABLED:"Cannot publish since liveEdit is enabled for this document type",ALREADY_PUBLISHED:"Already published",NO_CHANGES:"No unpublished changes",NOT_READY:"Operation not ready"},nT=e=>{var t,n,i;let{id:r,type:o,liveEdit:l,draft:s,published:a}=e,[c,d]=(0,Q.useState)(null),{publish:u}=(0,G.d9t)(r,o),p=(0,G.a3k)(r,o),h=(0,G.nuD)(r,o),{changesOpen:m,onHistoryOpen:f,documentId:x,documentType:g}=nC(),y=(0,G.iav)(x,g),v=((null==y?void 0:y.draft)||(null==y?void 0:y.published)||{})._rev,b=p.validation.some(e_.YN),[j,w]=(0,Q.useState)(!1),I=h.isSyncing,C=p.isValidating,[_,T]=(0,G.hHf)({id:r,type:o,permission:"publish"}),k=(0,G.xJ)(),E=u.disabled?(n=u.disabled,i=(a||{})._updatedAt,("ALREADY_PUBLISHED"===n&&i?(0,Y.jsx)(Y.Fragment,{children:(0,Y.jsxs)("span",{children:["Published ",(0,Y.jsx)(eX,{time:i})]})}):n_[n])||""):b?"There are validation errors that need to be fixed before this document can be published":"",P=!!s,A=(0,Q.useCallback)(()=>{u.execute(),d("publishing")},[u]);(0,Q.useEffect)(()=>{let e=!1===p.isValidating&&p.revision!==v;j&&!I&&e&&(b||A(),w(!1))},[I,A,b,j,p.revision,v,C,p.isValidating]),(0,Q.useEffect)(()=>{let e="publishing"===c&&!P;e&&m&&f();let t=e?"published":null,n=setTimeout(()=>{d(t)},e?200:4e3);return()=>clearTimeout(n)},[m,c,P,f]);let D=(0,Q.useCallback)(()=>{h.isSyncing||p.isValidating||p.revision!==v?w(!0):A()},[h.isSyncing,p.isValidating,p.revision,v,A]);if(l)return{tone:"positive",label:"Publish",title:"Live Edit is enabled for this content type and publishing happens automatically as you make changes",disabled:!0};if(!T&&!(null==_?void 0:_.granted))return{tone:"positive",label:"Publish",title:(0,Y.jsx)(G.FMn,{operationLabel:"publish this document",currentUser:k}),disabled:!0};let S=!!(j||(null==(t=null==y?void 0:y.transactionSyncLock)?void 0:t.enabled)||"publishing"===c||"published"===c||b||u.disabled);return{disabled:S||T,tone:"positive",label:"published"===c?"Published":j||"publishing"===c?"Publishing…":"Publish",icon:"published"===c?$.KML:$.EI4,title:j?"Waiting for tasks to finish before publishing":"published"===c||"publishing"===c?null:E,shortcut:S||j?null:"Ctrl+Alt+P",onHandle:D}};nT.action="publish";let nk={NOT_PUBLISHED:"This document is not published"},nE=e=>{let{id:t,type:n,draft:i,onComplete:r,liveEdit:o}=e,{unpublish:l}=(0,G.d9t)(t,n),[s,a]=(0,Q.useState)(!1),[c,d]=(0,G.hHf)({id:t,type:n,permission:"unpublish"}),u=(0,G.xJ)(),p=(0,Q.useCallback)(()=>{a(!1),r()},[r]),h=(0,Q.useCallback)(()=>{a(!1),l.execute(),r()},[r,l]),m=(0,Q.useMemo)(()=>s?{type:"dialog",onClose:r,content:(0,Y.jsx)(tv,{id:(null==i?void 0:i._id)||t,type:n,action:"unpublish",onCancel:p,onConfirm:h})}:null,[i,t,p,h,s,r,n]);return o?null:d||(null==c?void 0:c.granted)?{tone:"critical",icon:$.xEY,disabled:!!l.disabled||d,label:"Unpublish",title:l.disabled?nk[l.disabled]:"",onHandle:()=>a(!0),dialog:m}:{tone:"critical",icon:$.xEY,label:"Unpublish",title:(0,Y.jsx)(G.FMn,{operationLabel:"unpublish this document",currentUser:u}),disabled:!0}};nE.action="unpublish";let nP=!1,nA={},nD=Symbol("LOADING_PANE"),nS="documentPanelPortalElement",nR={activePanes:[]};function nO(e){nR.activePanes=e}function nz(e,t,n,i){var r;let o=(null==n?void 0:n.panes)||[],l=nR.activePanes||[],s=t.id||(0,eT.Z)(),a="create"===e&&t.template;for(let n=l.length-1;n>=0;n--){let c=l[n];if("object"==typeof c&&((null==(r=c.canHandleIntent)?void 0:r.call(c,e,t,{pane:c,index:n}))||"documentList"===c.type&&c.schemaTypeName===t.type&&"_type == $type"===c.options.filter)){let e=a?{template:t.template}:nA;return{panes:o.slice(0,n).concat([[{id:s,params:e,payload:i}]])}}}return{intent:e,params:t,payload:i}}let nM={},nL=eg.BC.create("/",[eg.BC.intents("/intent"),eg.BC.create("/edit/:type/:editDocumentId",[eg.BC.create({path:"/:params",transform:{params:{toState:function(e){try{return JSON.parse(decodeURIComponent(e))}catch(e){return console.warn("Failed to parse JSON parameters"),{}}},toPath:function(e){return JSON.stringify(e)}}}})]),eg.BC.create({path:"/:panes",children:[eg.BC.create("/:action",eg.BC.create("/:legacyEditDocumentId"))],transform:{panes:{toState:function(e){var t;return -1!==(t=decodeURIComponent(e)).indexOf(",{")?function(e){let t=[],n=e;for(;n.length;){let[e,i,r]=n.match(nU)||[];if(!e){n=n.slice(1);continue}let o=r&&nF(r);t.push({id:i,payload:o}),n=n.slice(e.length)}return[t]}(t):t.split(";").map(e=>{let[t,...n]=e.split("|").map(e=>{let[t,...n]=e.split(",");return n.reduce((e,t)=>{if(nN(t)){let n=t.slice(0,t.indexOf("=")),i=t.slice(n.length+1);e.params={...e.params,[decodeURIComponent(n)]:decodeURIComponent(i)}}else nH(t)?e.payload=t?nF(atob(t)):void 0:console.warn("Unknown pane segment: %s - skipping",t);return e},{id:t,params:nM,payload:void 0})});return[t,...n.map(e=>({...t,...e,id:e.id||t.id,params:{...ev()(t.params,nV),...e.params},payload:e.payload||t.payload}))]}).filter(e=>e.length>0)},toPath:function(e){return(e||[]).map(e=>e.map(nZ).join("|")).map(encodeURIComponent).join(";")}}}})]),nU=/^([.a-z0-9_-]+),?({.*?})?(?:(;|$))/i,nN=e=>/^[a-z0-9]+=[^=]+/i.test(e),nH=e=>/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e),nV=["view","since","rev","inspect"],nB=Boolean;function nZ(e,t,n){let{payload:i,params:r={},id:o}=e,[l]=n,s=e===l,a=0!==t&&o===l.id,c=void 0===i?void 0:btoa(JSON.stringify(i)),d=Object.entries(r).filter(e=>{var t;let[n,i]=e;if(!i)return!1;if(s)return!0;let r=null==(t=l.params)?void 0:t[n];return!!(i!==r||nV.includes(n))}).map(e=>{let[t,n]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))});return[a?"":o].concat([d.length>0&&d,c].filter(nB).flat()).join(",")||","}function nF(e){try{return JSON.parse(e)}catch(e){console.warn("Failed to parse parameters: ".concat(e.message));return}}let nq=320,n$=600,nQ=320,nY=540,nG={},nW="inspect:",nX=[{id:"inspectors"},{id:"links"}],nJ="sanity/desk/history",nK=(0,X.ZP)(W.Zb)({position:"relative",zIndex:1,lineHeight:0,"&:after":{content:'""',display:"block",position:"absolute",left:0,bottom:-1,right:0,borderBottom:"1px solid var(--card-border-color)",opacity:.5}});function n0(e){let{as:t,children:n,closeButtonLabel:i,onClose:r,title:o,...l}=e;return(0,Y.jsxs)(nK,{...l,as:t,children:[(0,Y.jsxs)(W.kC,{padding:2,children:[(0,Y.jsx)(W.xu,{flex:1,padding:3,children:(0,Y.jsx)(W.xv,{as:"h1",size:1,weight:"semibold",children:o})}),(0,Y.jsx)(W.xu,{flex:"none",padding:1,children:(0,Y.jsx)(W.zx,{"aria-label":i,fontSize:1,icon:$.Two,mode:"bleed",onClick:r,padding:2})})]}),n]})}let n1=(0,Q.createContext)(null);function n2(){let e=(0,Q.useContext)(n1);if(!e)throw Error("DeskTool: missing context value");return e}var n3=Object.freeze,n5=Object.defineProperty;let n4=X.ZP.div(S||(S=n3(n5(a=["\n  position: absolute;\n  top: 0;\n  left: -4px;\n  bottom: 0;\n  width: 9px;\n  z-index: 201;\n  cursor: ew-resize;\n\n  /* Border */\n  & > span:nth-child(1) {\n    display: block;\n    border-left: 1px solid var(--card-border-color);\n    position: absolute;\n    top: 0;\n    left: 4px;\n    bottom: 0;\n    transition: opacity 200ms;\n    opacity: 0.5;\n  }\n\n  /* Hover effect */\n  & > span:nth-child(2) {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 9px;\n    bottom: 0;\n    background-color: var(--card-border-color);\n    opacity: 0;\n    transition: opacity 150ms;\n  }\n\n  @media (hover: hover) {\n    &:hover > span:nth-child(2) {\n      opacity: 0.2;\n    }\n  }\n"],"raw",{value:n3(a.slice())}))));function n8(e){let{onResize:t,onResizeStart:n}=e,i=(0,Q.useRef)(0),r=(0,Q.useCallback)(e=>{e.preventDefault(),i.current=e.pageX,n();let r=e=>{e.preventDefault(),t(e.pageX-i.current)},o=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",o)},[t,n]);return(0,Y.jsxs)(n4,{onMouseDown:r,children:[(0,Y.jsx)("span",{}),(0,Y.jsx)("span",{})]})}var n9=Object.freeze,n6=Object.defineProperty;let n7=(0,X.ZP)(W.xu)(R||(R=n9(n6(c=["\n  position: relative;\n  flex: 1;\n  padding-left: 1px;\n"],"raw",{value:n9(c.slice())}))));function ie(e){let{as:t,children:n,minWidth:i,maxWidth:r,...o}=e,[l,s]=(0,Q.useState)(null),a=(0,Q.useRef)(),[c,d]=(0,Q.useState)(),u=(0,Q.useCallback)(()=>{a.current=null==l?void 0:l.offsetWidth},[l]),p=(0,Q.useCallback)(e=>{let t=a.current;t&&d(Math.min(Math.max(t-e,i),r))},[i,r]),h=(0,Q.useMemo)(()=>c?{flex:"none",width:c}:{minWidth:i,maxWidth:r},[i,r,c]);return(0,Y.jsxs)(n7,{as:t,...o,ref:s,style:h,children:[n,(0,Y.jsx)(n8,{onResize:p,onResizeStart:u})]})}let it={error:$.uIy,warning:$.foC,info:$.hQ6},ii={error:"critical",warning:"caution",info:"primary"};function ir(e){let{marker:t,onOpen:n,schemaType:i,value:r}=e,o=(0,Q.useCallback)(()=>n(t.path),[t,n]),[l,s]=(0,Q.useState)(null);return(0,Y.jsxs)(W.SV,{onCatch:s,children:[l&&(0,Y.jsx)(W.Zb,{padding:3,radius:2,tone:"critical",children:(0,Y.jsxs)(W.xv,{size:1,children:["ERROR: ",l.error.message]})}),!l&&(0,Y.jsx)(W.Zb,{__unstable_focusRing:!0,as:"button",onClick:o,padding:3,radius:2,tone:ii[t.level],children:(0,Y.jsxs)(W.kC,{align:"flex-start",gap:3,children:[(0,Y.jsx)(W.xu,{flex:"none",children:(0,Y.jsx)(W.xv,{size:1,children:(0,Q.createElement)(it[t.level])})}),(0,Y.jsxs)(W.Kq,{flex:1,space:2,children:[(0,Y.jsx)(io,{path:t.path,schemaType:i,value:r}),(0,Y.jsx)(W.xv,{muted:!0,size:1,children:t.item.message})]})]})})]})}function io(e){let{path:t,schemaType:n,value:i}=e,r=(0,Q.useMemo)(()=>(function(e){let{path:t,schemaType:n,value:i}=e,r=[],o=n,l=i;for(let e of t){if("string"==typeof e){if(!(0,G.Uy$)(l)&&void 0!==l)throw Error("Parent value is not an object, cannot get path segment: .".concat(e));if("object"!==o.jsonType)throw Error("Parent type is not an object schema type, cannot get path segment: .".concat(e));l=null==l?void 0:l[e];let t=o.fields.find(t=>t.name===e);if(!t)throw Error("Field type not found: .".concat(e));o=t.type,r.push(o);continue}if("number"==typeof e){if(!(0,G.kJL)(l)&&void 0!==l)throw Error("Parent value is not an array, cannot get path segment: [".concat(e,"]"));if("array"!==o.jsonType)throw Error("Parent type is not an array schema type, cannot get path segment: [".concat(e,"]"));l=null==l?void 0:l[e];let t=o.of.find(e=>"string"==typeof l?"string"===e.jsonType:"number"==typeof l?"number"===e.jsonType:"boolean"==typeof l?"boolean"===e.jsonType:!!(0,G.Uy$)(l)&&e.name===(null==l?void 0:l._type));if(!t)throw Error("Item type not found: [".concat(e,"]"));o=t,r.push(o);continue}if((0,G.Uy$)(e)&&e._key){if(!(0,G.kJL)(l))throw Error("Parent value is not an anrray, cannot get path segment: [_key == ".concat(e,"]"));if("array"!==o.jsonType)throw Error("Parent type is not an array schema type, cannot get path segment: .".concat(e));let t=null!=l?l:[];if(l=t.find(t=>(0,G.Uy$)(t)&&t._key===e._key),!(0,G.Uy$)(l))throw Error("Array item not found: [_key == ".concat(e._key,"]"));let n=o.of.find(e=>(0,G.Uy$)(l)&&e.name===(null==l?void 0:l._type));if(!n)throw Error("Array item type not found: .".concat(null==l?void 0:l._type));o=n,r.push(o);continue}throw Error("Invalid path segment: ".concat(JSON.stringify(e)))}return r})({path:t,schemaType:n,value:i}),[t,n,i]);return(0,Y.jsx)(W.xv,{size:1,children:r.map((e,t)=>(0,Y.jsxs)(Q.Fragment,{children:[t>0&&(0,Y.jsx)("span",{style:{color:"var(--card-muted-fg-color)",opacity:.5},children:" / "}),(0,Y.jsx)("span",{style:{fontWeight:500},children:e.title||e.name})]},t))})}let il={create:"created",delete:"deleted",discardDraft:"discarded draft",initial:"created",editDraft:"edited",editLive:"live edited",publish:"published",unpublish:"unpublished"},is={create:$.agZ,delete:$.XHJ,discardDraft:$.Two,initial:$.agZ,editDraft:$.dY8,editLive:$.dY8,publish:$.EI4,unpublish:$.xEY};function ia(e){let{maxLength:t,userIds:n}=e;return(0,Y.jsx)(W.Jh,{maxLength:t,children:n.map(e=>(0,Y.jsx)(G.YtX,{user:e,withTooltip:!0},e))})}var ic=Object.freeze,id=Object.defineProperty,iu=(e,t)=>ic(id(e,"raw",{value:ic(t||e.slice())}));let ip=(0,X.ZP)(W.kC)(e=>{var t;let{theme:n}=e,i=null==(t=n.sanity.color.base.skeleton)?void 0:t.from;return(0,X.iv)(O||(O=iu(["\n    --timeline-hairline-width: 1px;\n    position: relative;\n    z-index: 2;\n    margin: 0;\n    padding: 0;\n\n    &::before {\n      position: absolute;\n      content: '';\n      height: 100%;\n      width: var(--timeline-hairline-width);\n      background: ",";\n      top: 0;\n      left: calc((100% - var(--timeline-hairline-width)) / 2);\n      z-index: 1;\n    }\n  "])),i)}),ih=(0,X.ZP)(W.zx)(e=>{let{$selected:t}=e;return(0,X.iv)(M||(M=iu(["\n    position: relative;\n    width: 100%;\n\n    /* Line styling */\n    &[data-first] ","::before {\n      height: 50%;\n      top: unset;\n      bottom: 0;\n    }\n\n    &[data-last] ","::before {\n      height: 50%;\n    }\n\n    ","\n  "])),ip,ip,t&&(0,X.iv)(z||(z=iu(["\n      ","::before {\n        background: transparent;\n      }\n    "])),ip))}),im=(0,X.ZP)(W.xu)(L||(L=iu(["\n  background: var(--card-bg-color);\n  border-radius: 50px;\n  position: relative;\n  z-index: 2;\n"]))),ix=(0,X.ZP)(W.xv)(U||(U=iu(["\n  text-transform: capitalize;\n"]))),ig=(0,X.ZP)(W.xu)(N||(N=iu(["\n  min-width: 1rem;\n  margin-left: ",";\n"])),e=>{let{theme:t}=e;return"-".concat((0,W.hO)(t.sanity.space[1]))}),iy={initial:"primary",create:"primary",publish:"positive",editLive:"caution",editDraft:"caution",unpublish:"critical",discardDraft:"critical",delete:"critical",withinSelection:"primary"};function iv(e){let{chunk:t,isFirst:n,isLast:i,isLatest:r,isSelected:o,onSelect:l,timestamp:s,type:a}=e,c=is[a],d=Array.from(t.authors),u=(0,Q.useMemo)(()=>{let e=new Date(s),t=(0,ek.Z)(e,"MMM d, yyyy, hh:mm a");return t},[s]),p=(0,Q.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l(t)},[l,t]);return(0,Y.jsx)(ih,{$selected:o,"data-chunk-id":t.id,"data-first":!!n||void 0,"data-last":!!i||void 0,"data-ui":"timelineItem",mode:o?"default":"bleed",onClick:p,padding:0,radius:2,tone:o?"primary":iy[t.type],children:(0,Y.jsx)(W.xu,{paddingX:2,children:(0,Y.jsxs)(W.kC,{align:"stretch",children:[(0,Y.jsx)(ip,{align:"center",children:(0,Y.jsx)(im,{padding:2,children:(0,Y.jsx)(W.xv,{size:2,children:c&&(0,Q.createElement)(c)})})}),(0,Y.jsxs)(W.Kq,{space:2,margin:2,children:[r&&(0,Y.jsx)(W.kC,{children:(0,Y.jsx)(W.Zb,{padding:1,radius:2,shadow:1,tone:o?"primary":iy[t.type],children:(0,Y.jsx)(W.__,{muted:!0,size:0,children:"Latest"})})}),(0,Y.jsx)(W.xu,{children:(0,Y.jsx)(ix,{size:1,weight:"medium",children:il[a]||(0,Y.jsx)("code",{children:a})})}),(0,Y.jsx)(ig,{paddingX:1,children:(0,Y.jsx)(W.xv,{size:0,muted:!0,children:u})})]}),(0,Y.jsx)(W.kC,{flex:1,justify:"flex-end",align:"center",children:(0,Y.jsx)(ia,{maxLength:3,userIds:d})})]})})})}var ib=Object.freeze,ij=Object.defineProperty,iw=(e,t)=>ib(ij(e,"raw",{value:ib(t||e.slice())}));let iI=(0,X.ZP)(W.Kq)(H||(H=iw(["\n  max-width: 200px;\n"]))),iC=(0,X.ZP)(W.kC)(V||(V=iw(["\n  max-height: calc(100vh - 198px);\n  min-width: 244px;\n"]))),i_=(0,X.ZP)(W.xu)(e=>{let{$visible:t}=e;return(0,X.iv)(Z||(Z=iw(["\n    opacity: 0;\n    pointer-events: none;\n\n    ","\n  "])),t&&(0,X.iv)(B||(B=iw(["\n      opacity: 1;\n      pointer-events: auto;\n    "]))))}),iT=e=>{let{chunks:t,disabledBeforeFirstChunk:n,hasMoreChunks:i,lastChunk:r,onLoadMore:o,onSelect:l,firstChunk:s}=e,[a,c]=(0,Q.useState)(!1),d=(0,Q.useMemo)(()=>t.filter(e=>!n||!s||e.index<s.index),[t,n,s]),u=(0,Q.useMemo)(()=>(null==r?void 0:r.id)?d.findIndex(e=>e.id===r.id):-1,[null==r?void 0:r.id,d]),p=(0,Q.useCallback)((e,t)=>{let{activeIndex:r}=t,o=0===r,s=d&&r===d.length-1||!1;return(0,Y.jsxs)(W.xu,{paddingBottom:s?1:0,paddingTop:o?1:0,paddingX:1,children:[(0,Y.jsx)(iv,{chunk:e,isFirst:o,isLast:s,isLatest:0===r&&!n,isSelected:r===u,onSelect:l,timestamp:e.endTimestamp,type:e.type}),r===d.length-1&&i&&(0,Y.jsx)(W.kC,{align:"center",justify:"center",padding:4,children:(0,Y.jsx)(W.$j,{muted:!0})})]})},[n,d,i,l,u]);return(0,Q.useEffect)(()=>c(!0),[]),(0,Y.jsxs)(i_,{$visible:!u||a,"data-ui":"timeline",children:[0===d.length&&(0,Y.jsxs)(iI,{padding:3,space:3,children:[(0,Y.jsx)(W.xv,{size:1,weight:"semibold",children:"No document history"}),(0,Y.jsx)(W.xv,{muted:!0,size:1,children:"When changing the content of the document, the document versions will appear in this menu."})]}),d.length>0&&(0,Y.jsx)(iC,{direction:"column",children:(0,Y.jsx)(G.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:"Document revisions",autoFocus:"list",initialIndex:u,initialScrollAlign:"center",itemHeight:40,items:d,onEndReached:o,onEndReachedIndexOffset:20,overscan:5,renderItem:p,wrapAround:!1})})]})};function ik(){return(0,Y.jsxs)(W.kC,{align:"flex-start",gap:3,padding:4,children:[(0,Y.jsx)(G.LPT,{tone:"critical",children:(0,Y.jsx)($.uIy,{})}),(0,Y.jsxs)(W.Kq,{space:4,children:[(0,Y.jsx)(G.LPT,{size:1,tone:"critical",weight:"semibold",children:"An error occurred whilst retrieving document changes."}),(0,Y.jsx)(G.LPT,{size:1,tone:"critical",children:"Document history transactions have not been affected."})]})]})}iT.displayName="Timeline";var iE=Object.freeze,iP=Object.defineProperty;let iA=(0,X.ZP)(W.J2)(F||(F=iE(iP(d=["\n  overflow: hidden;\n  overflow: clip;\n"],"raw",{value:iE(d.slice())}))));function iD(e){let{chunk:t,mode:n,placement:i}=e,{setTimelineRange:r,setTimelineMode:o,timelineError:l,ready:s,timelineStore:a}=nC(),[c,d]=(0,Q.useState)(!1),[u,p]=(0,Q.useState)(null),[h,m]=(0,Q.useState)(null),f=(0,W.pm)(),x=(0,G.P08)(a,e=>e.chunks),g=(0,G.P08)(a,e=>e.isLoading),y=(0,G.P08)(a,e=>e.hasMoreChunks),v=(0,G.P08)(a,e=>e.realRevChunk),b=(0,G.P08)(a,e=>e.sinceTime),j=(0,Q.useCallback)(()=>{o(n),d(!0)},[n,o]),w=(0,Q.useCallback)(()=>{o("closed"),d(!1)},[o]),I=(0,Q.useCallback)(()=>{c&&w()},[w,c]),C=(0,Q.useCallback)(e=>{c&&("Escape"===e.key||"Tab"===e.key)&&(w(),null==u||u.focus())},[u,w,c]);(0,W.O8)(I,[u,h]),(0,W.qh)(C);let _=(0,Q.useCallback)(e=>{try{let[t,n]=a.findRangeForRev(e);o("closed"),r(t,n)}catch(e){f.push({closable:!0,description:e.message,status:"error",title:"Unable to load revision"})}},[o,r,a,f]),T=(0,Q.useCallback)(e=>{try{let[t,n]=a.findRangeForSince(e);o("closed"),r(t,n)}catch(e){f.push({closable:!0,description:e.message,status:"error",title:"Unable to load revision"})}},[o,r,a,f]),k=(0,Q.useCallback)(()=>{g||a.loadMore()},[g,a]),E=l?(0,Y.jsx)(ik,{}):(0,Y.jsxs)(Y.Fragment,{children:["rev"===n&&(0,Y.jsx)(iT,{chunks:x,firstChunk:v,hasMoreChunks:y,lastChunk:v,onLoadMore:k,onSelect:_}),"since"===n&&(0,Y.jsx)(iT,{chunks:x,disabledBeforeFirstChunk:!0,firstChunk:v,hasMoreChunks:y,lastChunk:b,onLoadMore:k,onSelect:T})]}),P=function(e){let t=(0,Q.useMemo)(()=>{let t=e?new Date(e):new Date,n=(0,ek.Z)(t,"MMM d, yyyy, hh:mm a");return n},[e]);return t}((null==t?void 0:t.endTimestamp)||""),A=t?"".concat(eP()(il[t.type]),": ").concat(P):"Latest version",D=t?"Since: ".concat(P):"Since: unknown version",S="rev"===n?A:D;return(0,Y.jsx)(iA,{constrainSize:!0,content:c&&E,"data-ui":"versionMenu",open:c,placement:i,portal:!0,ref:m,children:(0,Y.jsx)(W.zx,{disabled:!s,mode:"bleed",fontSize:1,padding:2,iconRight:$.GVG,onClick:c?w:j,ref:p,selected:c,style:{maxWidth:"100%"},text:s?S:"Loading history"})})}function iS(){return(0,Y.jsx)(eG,{ms:300,children:(0,Y.jsxs)(W.kC,{align:"center",direction:"column",height:"fill",justify:"center",paddingTop:3,children:[(0,Y.jsx)(W.$j,{muted:!0}),(0,Y.jsx)(W.xu,{marginTop:3,children:(0,Y.jsx)(W.xv,{align:"center",muted:!0,size:1,children:"Loading changes"})})]})})}var iR=Object.freeze,iO=Object.defineProperty;let iz=(0,X.ZP)(G.l$t)(q||(q=iR(iO(u=["\n  height: 100%;\n  overflow: auto;\n  position: relative;\n  scroll-behavior: smooth;\n"],"raw",{value:iR(u.slice())}))));function iM(e){let{error:t,diff:n,documentContext:i,loading:r,schemaType:o}=e;return t?(0,Y.jsx)(G.kwM,{}):r?(0,Y.jsx)(iS,{}):n?(0,Y.jsx)(G.H7Z.Provider,{value:i,children:(0,Y.jsx)(G.EyJ,{diff:n,schemaType:o})}):(0,Y.jsx)(G.kwM,{})}let iL=[nT,nE,nv,nj,ng,nw],iU=[e=>{let{liveEdit:t}=e;return t?{label:"Live",color:"danger"}:null}],iN=[{name:"sanity/desk/validation",component:function(e){let{onClose:t}=e,{onFocus:n,onPathOpen:i,schemaType:r,validation:o,value:l}=nC(),s=(0,Q.useCallback)(e=>{i(e),n(e)},[n,i]);return(0,Y.jsxs)(W.kC,{direction:"column",height:"fill",overflow:"hidden",children:[(0,Y.jsx)(n0,{as:"header",closeButtonLabel:"Close validation",flex:"none",onClose:t,title:"Validation"}),(0,Y.jsxs)(W.Zb,{flex:1,overflow:"auto",padding:3,children:[0===o.length&&(0,Y.jsx)(W.xu,{padding:2,children:(0,Y.jsx)(W.xv,{muted:!0,size:1,children:"No validation errors"})}),o.length>0&&(0,Y.jsx)(W.Kq,{space:2,children:o.map(e=>(0,Y.jsx)(ir,{marker:e,onOpen:s,schemaType:r,value:l},(0,G.va7)(e.path)))})]})]})},useMenuItem:function(e){let{documentId:t,documentType:n}=e,{validation:i}=(0,G.a3k)(t,n),r=(0,Q.useMemo)(()=>i.map(e=>({level:e.level,message:e.item.message,path:e.path})),[i]),o=r.some(G.z12),l=r.some(G.AY8),s=(0,Q.useMemo)(()=>o?$.uIy:l?$.foC:$.nSX,[o,l]),a=(0,Q.useMemo)(()=>o?"critical":l?"caution":"positive",[o,l]);return{hidden:0===r.length,icon:s,title:"Validation",tone:a,showAsAction:!0}}},{name:nJ,useMenuItem:()=>{let{features:e}=n2();return{hidden:!e.reviewChanges,icon:$.vaD,title:"Review changes"}},component:function(e){let{onClose:t}=e,{documentId:n,schemaType:i,timelineError:r,timelineStore:o,value:l}=nC(),s=(0,Q.useRef)(null),a=(0,G.P08)(o,e=>e.diff),c=(0,G.P08)(o,e=>e.onOlderRevision),d=(0,G.P08)(o,e=>e.selectionState),u=(0,G.P08)(o,e=>e.sinceTime),p=!c,h=Q.useMemo(()=>({documentId:n,schemaType:i,FieldWrapper:G.MUX,rootDiff:a,isComparingCurrent:p,value:l}),[n,a,p,i,l]),m=Q.useMemo(()=>a?function(e){let t=new Map;return(0,G.Z7x)(e,e=>{if("unchanged"===e.action||!("annotation"in e)||!e.annotation)return!0;let{author:n,timestamp:i}=e.annotation,r=t.get(n);return(!r||r.timestamp<i)&&t.set(n,e.annotation),!0}),Array.from(t.values()).sort((e,t)=>e.timestamp<t.timestamp?1:-1)}(a):[],[a]);return(0,Y.jsxs)(W.kC,{"data-testid":"review-changes-pane",direction:"column",height:"fill",overflow:"hidden",children:[(0,Y.jsx)(n0,{as:"header",closeButtonLabel:"Close review changes",flex:"none",onClose:t,title:"Review changes",children:(0,Y.jsxs)(W.kC,{gap:1,padding:3,paddingTop:0,paddingBottom:2,children:[(0,Y.jsx)(W.xu,{flex:1,children:(0,Y.jsx)(iD,{mode:"since",chunk:u,placement:"bottom-start"})}),(0,Y.jsx)(W.xu,{flex:"none",children:(0,Y.jsx)(G.IIC,{annotations:m,description:"Changes by",portal:!0,children:(0,Y.jsx)(W.Jh,{maxLength:4,"aria-label":"Changes by",children:m.map(e=>{let{author:t}=e;return(0,Y.jsx)(G.YtX,{user:t},t)})})})})]})}),(0,Y.jsx)(W.Zb,{flex:1,children:(0,Y.jsx)(W.NM,{element:s.current,children:(0,Y.jsx)(iz,{"data-ui":"Scroller",ref:s,children:(0,Y.jsx)(W.xu,{flex:1,padding:4,children:(0,Y.jsx)(iM,{diff:a,documentContext:h,error:r,loading:"loading"===d,schemaType:i})})})})})]})},onClose:e=>{let{params:t}=e;return{params:{...t,since:void 0}}},onOpen:e=>{let{params:t}=e;return{params:{...t,since:"@lastPublished"}}}}],iH=(0,G.Cw0)(e=>({name:"@sanity/desk-tool",document:{actions:e=>Array.from(new Set([...e,...iL])),badges:e=>Array.from(new Set([...e,...iU])),inspectors:e=>Array.from(new Set([...e,...iN]))},tools:[{name:(null==e?void 0:e.name)||"desk",title:(null==e?void 0:e.title)||"Desk",icon:(null==e?void 0:e.icon)||$.kLv,component:(0,Q.lazy)(()=>Promise.all([n.e(870),n.e(766)]).then(n.bind(n,4766)).then(function(e){return e.index})),canHandleIntent:(e,t)=>!!("edit"===e&&t.id||"create"===e&&t.type||"create"===e&&t.template),getIntentState:nz,options:e,router:nL}]})),iV=e=>(0,G.Uy$)(e)&&"string"==typeof e._id&&"string"==typeof e._type,iB=(0,Q.memo)(function(e){let{documentId:t,documentType:n,index:i,setMenuItem:r,useMenuItem:o}=e,l=(0,G.BoV)(o({documentId:t,documentType:n}));return(0,Q.useEffect)(()=>{r(i,l)},[i,l,r]),(0,Y.jsx)(Y.Fragment,{})});function iZ(e){let{documentId:t,documentType:n,inspectors:i,onMenuItems:r}=e,o=i.length,l=(0,Q.useRef)(o),[s,a]=(0,Q.useState)(()=>Array.from(Array(o))),c=(0,Q.useRef)(s);(0,Q.useEffect)(()=>{if(l.current!==o){let e=Array.from(Array(o));for(let t=0;t<o;t++)e[t]=c.current[t];l.current=o,a(()=>(c.current=e,e))}},[o]);let d=(0,Q.useCallback)((e,t)=>{a(n=>{let i=[...n];return i[e]=t,c.current=i,i})},[]);return(0,Q.useEffect)(()=>{r(s.filter(Boolean))},[s,r]),(0,Y.jsx)(Y.Fragment,{children:i.map((e,i)=>e.useMenuItem&&(0,Y.jsx)(iB,{documentId:t,documentType:n,index:i,setMenuItem:d,useMenuItem:e.useMenuItem},e.name))})}let iF=(0,Q.memo)(e=>{let{children:t,index:n,pane:i,paneKey:r}=e,o=(0,G.I_y)(),l=(0,G.zEW)(),{actions:s,badges:a,unstable_fieldActions:c,unstable_languageFilter:d,inspectors:u}=(0,G.Lky)().document,p=(0,G.ap5)(),h=te(),m=h.setParams,{features:f}=n2(),{push:x}=(0,W.pm)(),{options:g,menuItemGroups:y=nX,title:v=null,views:b=[]}=i,j=(0,G.BoV)(g),w=j.id,I=(0,G.vsM)(w),C=g.type,_=(0,G.BoV)(h.params)||nG,T=(0,G.BoV)(h.payload),{templateName:k,templateParams:E}=(0,Q.useMemo)(()=>(function(e,t){let n=t.panePayload||{},i=t.templateName;t.urlTemplate&&i&&i!==t.urlTemplate&&console.warn('Conflicting templates: URL says "'.concat(t.urlTemplate,'", structure node says "').concat(i,'". Using "').concat(i,'".'));let r=i||t.urlTemplate,o=e.filter(e=>e.schemaType===t.documentType),l={...t.templateParams,..."object"==typeof n&&n||{}},s=r;return r||1!==o.length||(s=o[0].id),{templateName:s,templateParams:l}})(l,{documentType:C,templateName:j.template,templateParams:j.templateParameters,panePayload:T,urlTemplate:_.template}),[C,j,_,T,l]),P=(0,G.t2O)({documentId:I,documentType:C,templateName:k,templateParams:E}),A=(0,G.BoV)(P),{patch:D}=(0,G.d9t)(I,C),S=(0,G.iav)(I,C),{validation:R}=(0,G.a3k)(I,C),O=(0,G.z1O)(I,C),z=o.get(C),M=(null==S?void 0:S.draft)||(null==S?void 0:S.published)||A.value,[L,U]=(0,Q.useState)([]),N=(0,Q.useMemo)(()=>s({schemaType:C,documentId:I}),[s,I,C]),H=(0,Q.useMemo)(()=>a({schemaType:C,documentId:I}),[a,I,C]),V=(0,Q.useMemo)(()=>d({schemaType:C,documentId:I}),[I,C,d]),B=(0,G.BoV)(R),Z=(0,G.BoV)(b),[F,q]=(0,Q.useState)(()=>_.path?(0,eb.mL)(_.path):[]),X=_.view||Z[0]&&Z[0].id||null,[J,K]=(0,Q.useState)("closed"),[ee,ei]=(0,Q.useState)(null),er=(0,G.Dab)({documentId:I,documentType:C,onError:ei,rev:_.rev,since:_.since}),eo=(0,G.P08)(er,e=>e.onOlderRevision),es=(0,G.P08)(er,e=>e.revTime),ed=(0,G.P08)(er,e=>e.sinceAttributes),eu=(0,G.P08)(er,e=>e.timelineDisplayed),ep=(0,G.P08)(er,e=>e.timelineReady),eh=function(e){let[t,n]=(0,Q.useState)(void 0),[i,r]=(0,Q.useState)(null),{resolveProductionUrl:o}=(0,G.Lky)().document,l=(0,ex.l)(e);if(i)throw i;return(0,Q.useEffect)(()=>{l.pipe((0,ec.b)(500),(0,el.w)(e=>iV(e)?(0,en.D)(o({document:e})):(0,et.of)(void 0)),(0,ea.K)(e=>{let t=(0,G.Uy$)(e)&&"string"==typeof e.message?e.message:"Unknown error";throw Error("An error was thrown while trying to get your preview url: ".concat(t))})).subscribe({next:n,error:r})},[o,l]),t}(M),[em,ef]=(0,Q.useState)([]);(0,Q.useEffect)(()=>{let e=p.documentPresence(I).subscribe(e=>{ef(e)});return()=>{e.unsubscribe()}},[I,p]);let eg=(0,Q.useMemo)(()=>u({documentId:I,documentType:C}),[I,C,u]),[ey,ej]=(0,Q.useState)(()=>_.inspect||null),ew=(0,Q.useRef)(_.inspect);(0,Q.useEffect)(()=>{ew.current!==_.inspect&&(ew.current=_.inspect,ej(_.inspect||null))},[_.inspect]);let eI=null==eg?void 0:eg.find(e=>e.name===ey),eC=eg.find(e=>e.name===nJ),e_=(null==eI?void 0:eI.name)===nJ,eT=!!M,ek=(0,Q.useMemo)(()=>(function(e){let t=function(e){let{currentInspector:t,hasValue:n,inspectors:i,inspectorMenuItems:r}=e;return i.map((e,i)=>{var o;let l=r[i];return!l||l.hidden?null:{action:"".concat(nW).concat(e.name),group:l.showAsAction?void 0:"inspectors",icon:l.icon,isDisabled:!n,selected:(null==t?void 0:t.name)===e.name,shortcut:null==(o=l.hotkeys)?void 0:o.join("+"),showAsAction:l.showAsAction,title:l.title,tone:l.tone}}).filter(Boolean)}(e),n=[function(e){let{previewUrl:t}=e;return t?{action:"production-preview",group:"links",title:"Open preview",icon:$.YE8,shortcut:"Ctrl+Alt+O"}:null}(e)].filter(Boolean);return[...t,function(e){let{hasValue:t}=e;return{action:"inspect",group:"inspectors",title:"Inspect",icon:$.bg6,isDisabled:!t,shortcut:"Ctrl+Alt+I"}}(e),...n]})({currentInspector:eI,features:f,hasValue:eT,inspectorMenuItems:L,inspectors:eg,previewUrl:eh}),[eI,f,eT,L,eg,eh]),eE="on"===_.inspect,eP=e_?ed:(null==S?void 0:S.published)||null,eS=(0,Q.useMemo)(()=>z?c({documentId:I,documentType:C,schemaType:z}):[],[I,C,c,z]),eR="connected"===O&&S.ready&&(ep||!!ee),eO=(0,Q.useMemo)(()=>eo?eu||{_id:M._id,_type:M._type}:M,[eo,eu,M]),ez=(0,Q.useCallback)((e,t)=>{m({..._,since:e,rev:t||void 0})},[_,m]),eM=(0,Q.useCallback)(e=>{q(e),p.setLocation([{type:"document",documentId:I,path:e,lastActiveAt:new Date().toISOString()}])},[I,p,q]),eL=(0,Q.useCallback)(e=>{q([])},[q]),eU=(0,Q.useRef)(()=>{throw Error("Nope")});eU.current=e=>{D.execute((0,G.GWp)(e.patches),A.value)};let eN=(0,Q.useCallback)(e=>eU.current(e),[]),eH=(0,Q.useCallback)(e=>{var t,n,i,r;let o=e&&eg.find(t=>t.name===e);if(e&&!o){console.warn('No inspector named "'.concat(e,'"'));return}if(eI){if(o){let e=null!=(n=null==(t=o.onClose)?void 0:t.call(o,{params:_}))?n:{params:_};ej(null),ew.current=void 0,m({...e.params,inspect:void 0});return}if(eI){let e=null!=(r=null==(i=eI.onClose)?void 0:i.call(eI,{params:_}))?r:{params:_};ej(null),ew.current=void 0,m({...e.params,inspect:void 0})}}},[eI,eg,_,m]),eV=(0,Q.useCallback)((e,t)=>{var n,i,r,o;let l=eg.find(t=>t.name===e);if(!l){console.warn('No inspector named "'.concat(e,'"'));return}if((null==eI?void 0:eI.name)===l.name){m({..._,...t,inspect:l.name});return}let s=_;if(eI){let e=null!=(i=null==(n=l.onClose)?void 0:n.call(l,{params:s}))?i:{params:s};s=e.params}let a=null!=(o=null==(r=l.onOpen)?void 0:r.call(l,{params:s}))?o:{params:s};ej(l.name),ew.current=l.name,m({...a.params,...t,inspect:l.name})},[eI,eg,_,m]),eB=(0,Q.useCallback)(()=>{eC&&eH(eC.name)},[eH,eC]),eZ=(0,Q.useCallback)(()=>{f.reviewChanges&&eC&&eV(eC.name)},[f.reviewChanges,eV,eC]),eF=(0,Q.useCallback)(()=>h.closeCurrent(),[h]),eq=(0,Q.useCallback)(()=>h.duplicateCurrent(),[h]),e$=(0,Q.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!eE;e?m({..._,inspect:"on"}):m(ev()(_,"inspect"))},[eE,_,m]),eQ=(0,Q.useCallback)(e=>{if("production-preview"===e.action&&eh)return window.open(eh),!0;if("inspect"===e.action)return e$(!0),!0;if("reviewChanges"===e.action)return eZ(),!0;if("string"==typeof e.action&&e.action.startsWith(nW)){let t=e.action.slice(nW.length),n=eg.find(e=>e.name===t);if(n)return n.name===ey?eH(n.name):eV(n.name),!0}return!1},[eH,eZ,ey,eg,eV,eh,e$]),eY=(0,Q.useCallback)(e=>{for(let t of ek)if(t.shortcut&&(0,eA.ZP)(t.shortcut,e)){e.preventDefault(),e.stopPropagation(),eQ(t);return}},[eQ,ek]),eG=(0,Q.useCallback)(()=>e$(!1),[e$]),[eW,eX]=(0,Q.useState)([]),[eJ,eK]=(0,Q.useState)(),[e0,e1]=(0,Q.useState)(),[e2,e3]=(0,Q.useState)(),e5=(0,Q.useCallback)((e,t)=>{e1(n=>(0,G.pt$)(n,e,t))},[]),e4=(0,Q.useCallback)((e,t)=>{e3(n=>(0,G.pt$)(n,e,t))},[]),e8=(0,Q.useCallback)((e,t)=>eK(n=>(0,G.pt$)(n,e,t)),[]),e9=M._createdAt?"update":"create",e6=!!(null==z?void 0:z.liveEdit),e7=M._id?M._id:"dummy-id",tt=(0,Q.useMemo)(()=>({...M,_id:e6?(0,G.vsM)(e7):(0,G.qyu)(e7)}),[e6,M,e7]),[tn,ti]=(0,G.vSY)({document:tt,permission:e9}),tr=!(null==M?void 0:M._id),to=(0,Q.useMemo)(()=>{var e;let t=!ti&&!(null==tn?void 0:tn.granted),n=!(0,eD.jA)(z,"update"),i=tr&&!(0,eD.jA)(z,"create"),r="reconnecting"===O,o=null==(e=S.transactionSyncLock)?void 0:e.enabled;return!eR||null!==es||t||n||i||r||o},[O,tr,ti,null==tn?void 0:tn.granted,eR,es,z,S.transactionSyncLock]),tl=(0,G.clL)(z,{value:eO,readOnly:to,comparisonValue:eP,focusPath:F,openPath:eW,collapsedPaths:e0,presence:em,validation:B,collapsedFieldSets:e2,fieldGroupState:eJ,changesOpen:e_}),ts=(0,Q.useRef)(tl);ts.current=tl;let ta=(0,Q.useCallback)(e=>{let t=(0,G.C8M)(ts.current,e);t.forEach(e=>{"expandPath"===e.type&&e1(t=>(0,G.pt$)(t,e.path,!1)),"expandFieldSet"===e.type&&e3(t=>(0,G.pt$)(t,e.path,!1)),"setSelectedGroup"===e.type&&eK(t=>(0,G.pt$)(t,e.path,e.groupName))}),eX(e)},[ts]);(0,Q.useEffect)(()=>{"reconnecting"===O&&x({id:"sanity/desk/reconnecting",status:"warning",title:(0,Y.jsx)(Y.Fragment,{children:"Connection lost. Reconnecting…"})})},[O,x]),(0,Q.useEffect)(()=>{var e;if(eR&&_.path){let{path:t,...n}=_,i=(0,eb.vW)(null==(e=ts.current)?void 0:e.value,(0,eb.mL)(t));q(i),ta(i),h.setParams(n)}},[_,I,ta,eR,h]);let[tc,td]=(0,Q.useState)([]);return(0,Y.jsxs)(nI.Provider,{value:{actions:N,activeViewId:X,badges:H,changesOpen:e_,closeInspector:eH,collapsedFieldSets:e2,collapsedPaths:e0,compareValue:eP,connectionState:O,displayed:eO,documentId:I,documentIdRaw:w,documentType:C,editState:S,fieldActions:eS,focusPath:F,inspector:eI||null,inspectors:eg,menuItems:ek,onBlur:eL,onChange:eN,onFocus:eM,onPathOpen:ta,onHistoryClose:eB,onHistoryOpen:eZ,onInspectClose:eG,onKeyUp:eY,onMenuAction:eQ,onPaneClose:eF,onPaneSplit:eq,onSetActiveFieldGroup:e8,onSetCollapsedPath:e5,onSetCollapsedFieldSet:e4,openInspector:eV,index:n,inspectOpen:eE,validation:B,menuItemGroups:y||[],paneKey:r,previewUrl:eh,ready:eR,schemaType:z,isPermissionsLoading:ti,permissions:tn,setTimelineMode:K,setTimelineRange:ez,timelineError:ee,timelineMode:J,timelineStore:er,title:v,value:M,views:Z,formState:tl,unstable_languageFilter:V},children:[eg.length>0&&(0,Y.jsx)(iZ,{documentId:I,documentType:C,inspectors:eg,onMenuItems:U}),eS.length>0&&z&&(0,Y.jsx)(G.QMc,{actions:eS,documentId:I,documentType:C,onActions:td,path:G.LZ8,schemaType:z}),(0,Y.jsx)(G.kNp,{actions:tc,path:G.LZ8,children:t})]})});iF.displayName="DocumentPaneProvider";var iq=Object.defineProperty,i$=(e,t,n)=>t in e?iq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,iQ=(e,t,n)=>(i$(e,"symbol"!=typeof t?t+"":t,n),n);class iY extends Error{constructor(e,t,n,i){super(e),iQ(this,"path"),iQ(this,"helpId");let r=void 0===n?"<unknown>":"".concat(n);this.path=(t||[]).concat(i?"".concat(r," (").concat(i,")"):r)}withHelpUrl(e){return this.helpId=e,this}}var iG=((p=iG||{}).ID_REQUIRED="structure-node-id-required",p.TITLE_REQUIRED="structure-title-required",p.FILTER_REQUIRED="structure-filter-required",p.INVALID_LIST_ITEM="structure-invalid-list-item",p.COMPONENT_REQUIRED="structure-view-component-required",p.DOCUMENT_ID_REQUIRED="structure-document-id-required",p.DOCUMENT_TYPE_REQUIRED="structure-document-type-required",p.SCHEMA_TYPE_REQUIRED="structure-schema-type-required",p.SCHEMA_TYPE_NOT_FOUND="structure-schema-type-not-found",p.LIST_ITEMS_MUST_BE_ARRAY="structure-list-items-must-be-array",p.QUERY_PROVIDED_FOR_FILTER="structure-query-provided-for-filter",p.ACTION_OR_INTENT_REQUIRED="structure-action-or-intent-required",p.LIST_ITEM_IDS_MUST_BE_UNIQUE="structure-list-item-ids-must-be-unique",p.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE="structure-action-and-intent-mutually-exclusive",p);let iW=["_id","_type","_createdAt","_updatedAt","_rev"],iX={title:"Last edited",name:"lastEditedDesc",by:[{field:"_updatedAt",direction:"desc"}]},iJ=[iX,{title:"Created",name:"lastCreatedDesc",by:[{field:"_createdAt",direction:"desc"}]}];var iK=Object.defineProperty,i0=(e,t,n)=>t in e?iK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,i1=(e,t,n)=>(i0(e,"symbol"!=typeof t?t+"":t,n),n);function i2(e,t,n){return e instanceof i3?e.serialize({path:n,index:t}):e}class i3{constructor(e,t){this._context=e,i1(this,"spec"),this.spec=t||{}}action(e){return this.clone({action:e})}getAction(){return this.spec.action}intent(e){return this.clone({intent:e})}getIntent(){return this.spec.intent}title(e){return this.clone({title:e})}getTitle(){return this.spec.title}group(e){return this.clone({group:e})}getGroup(){return this.spec.group}icon(e){return this.clone({icon:e})}getIcon(){return this.spec.icon}params(e){return this.clone({params:e})}getParams(){return this.spec.params}showAsAction(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this.clone({showAsAction:!!e})}getShowAsAction(){return this.spec.showAsAction}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{title:t,action:n,intent:i}=this.spec;if(!t){let t="string"==typeof n?'action: "'.concat(n,'"'):void 0;throw new iY("`title` is required for menu item",e.path,e.index,t).withHelpUrl(iG.TITLE_REQUIRED)}if(!n&&!i)throw new iY("`action` or `intent` required for menu item with title ".concat(this.spec.title),e.path,e.index,'"'.concat(t,'"')).withHelpUrl(iG.ACTION_OR_INTENT_REQUIRED);if(i&&n)throw new iY("cannot set both `action` AND `intent`",e.path,e.index,'"'.concat(t,'"')).withHelpUrl(iG.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE);return{...this.spec,title:t}}clone(e){let t=new i3(this._context);return t.spec={...this.spec,...e||{}},t}}function i5(e,t,n){return new i3(e).group("sorting").title("Sort by ".concat(t.title)).icon($.fzI).action("setSortOrder").params({by:t.by,extendedProjection:n})}function i4(e,t){let{schema:n}=e,i="string"==typeof t?n.get(t):t;return i&&"orderings"in i?(i.orderings?i.orderings.concat(iJ):iJ).map(t=>i5(e,t,t.by.map(e=>(function e(t,n){let[i,...r]=n;if(!("fields"in t))return"";let o=t.fields.find(e=>e.name===i);if(!o)return iW.includes(i)||console.warn('The current ordering config targeted the nonexistent field "%s" on schema type "%s". It should be one of %o',i,t.name,t.fields.map(e=>e.name)),"";if("to"in o.type&&"reference"===o.type.name){let t=o.type.to;return"".concat(i,"->{").concat(t.map(t=>e(t,r)).join(","),"}")}let l=r.length>0&&e(o.type,r),s=l?"{".concat(l,"}"):"";return r.length>0?"".concat(i).concat(s):i})(i,e.field.split("."))).join(", "))):[]}var i8=Object.defineProperty,i9=(e,t,n)=>t in e?i8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,i6=(e,t,n)=>(i9(e,"symbol"!=typeof t?t+"":t,n),n);function i7(e,t,n){return e instanceof re?e.serialize({path:n,index:t}):e}class re{constructor(e,t){this._context=e,i6(this,"_id"),i6(this,"_title"),this._id=t?t.id:"",this._title=t?t.title:""}id(e){return new re(this._context,{id:e,title:this._title})}getId(){return this._id}title(e){return new re(this._context,{id:this._id,title:e})}getTitle(){return this._title}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{_id:t,_title:n}=this;if(!t)throw new iY("`id` is required for a menu item group",e.path,e.index,n).withHelpUrl(iG.ID_REQUIRED);if(!n)throw new iY("`title` is required for a menu item group",e.path,t).withHelpUrl(iG.TITLE_REQUIRED);return{id:t,title:n}}}let rt=/([^A-Za-z0-9-_.])/;function rn(e,t,n){if("string"!=typeof e)throw new iY("Structure node id must be of type string, got ".concat(typeof e),t,n);let[i]=e.match(rt)||[];if(i)throw new iY('Structure node id cannot contain character "'.concat(i,'"'),t,n);if(e.startsWith("__edit__"))throw new iY("Structure node id cannot start with __edit__",t,n);return e}function ri(e,t){if(t)return t;let n=eR()(e);return rt.test(n)?eR()(ez()(e)):n}var rr=Object.defineProperty,ro=(e,t,n)=>t in e?rr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rl=(e,t,n)=>(ro(e,"symbol"!=typeof t?t+"":t,n),n);class rs{constructor(e){rl(this,"spec"),this.spec={options:{},...e||{}}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:ri(e,this.spec.id)})}getTitle(){return this.spec.title}child(e){return this.clone({child:e})}getChild(){return this.spec.child}component(e){return this.clone({component:e})}getComponent(){return this.spec.component}options(e){return this.clone({options:e})}getOptions(){return this.spec.options||{}}menuItems(e){return this.clone({menuItems:e})}getMenuItems(){return this.spec.menuItems}menuItemGroups(e){return this.clone({menuItemGroups:e})}getMenuItemGroups(){return this.spec.menuItemGroups}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{id:t,title:n,child:i,options:r,component:o}=this.spec;if(!t)throw new iY("`id` is required for `component` structure item",e.path,e.index).withHelpUrl(iG.ID_REQUIRED);if(!o)throw new iY("`component` is required for `component` structure item",e.path,e.index).withHelpUrl(iG.ID_REQUIRED);return{id:rn(t,e.path,e.index),title:n,type:"component",child:i,component:o,options:r||{},menuItems:(this.spec.menuItems||[]).map((t,n)=>i2(t,n,e.path)),menuItemGroups:(this.spec.menuItemGroups||[]).map((t,n)=>i7(t,n,e.path))}}clone(e){let t=new rs;return t.spec={...this.spec,...e||{}},t}}async function ra(e,t){let n=(0,G.vsM)(t),i=(0,G.qyu)(t),r=await e(G.Dr7).fetch("*[_id in [$documentId, $draftId]]._type",{documentId:n,draftId:i},{tag:"structure.resolve-type"});return r[0]}var rc=Object.defineProperty,rd=(e,t,n)=>t in e?rc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ru=(e,t,n)=>(rd(e,"symbol"!=typeof t?t+"":t,n),n);class rp{constructor(){ru(this,"spec",{})}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:this.spec.id||eN()(e)})}getTitle(){return this.spec.title}icon(e){return this.clone({icon:e})}getIcon(){return this.spec.icon}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{id:t,title:n,icon:i}=this.spec;if(!t)throw new iY("`id` is required for view item",e.path,e.index).withHelpUrl(iG.ID_REQUIRED);if(!n)throw new iY("`title` is required for view item",e.path,e.index).withHelpUrl(iG.TITLE_REQUIRED);return{id:rn(t,e.path,e.index),title:n,icon:i}}}function rh(e,t,n){return"function"==typeof e.serialize?e.serialize({path:n,index:t}):e}var rm=Object.defineProperty,rf=(e,t,n)=>t in e?rm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rx=(e,t,n)=>(rf(e,"symbol"!=typeof t?t+"":t,n),n);let rg=e=>(0,G.Uy$)(e)&&"component"===e.type;class ry extends rp{constructor(e){let t=rg(e)?{...e}:{options:{}};super(),rx(this,"spec"),this.spec=t;let n="function"==typeof e?e:this.spec.component;n&&(this.spec=this.component(n).spec)}component(e){return this.clone({component:e})}getComponent(){return this.spec.component}options(e){return this.clone({options:e})}getOptions(){return this.spec.options||{}}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},t=super.serialize(e),n=this.spec.component;if("function"!=typeof n)throw new iY("`component` is required and must be a function for `component()` view item",e.path,e.index).withHelpUrl(iG.COMPONENT_REQUIRED);return{...t,component:n,options:this.spec.options||{},type:"component"}}clone(e){let t=new ry;return t.spec={...this.spec,...e||{}},t}}var rv=Object.defineProperty,rb=(e,t,n)=>t in e?rv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rj=(e,t,n)=>(rb(e,"symbol"!=typeof t?t+"":t,n),n);class rw extends rp{constructor(e){super(),rj(this,"spec"),this.spec={id:"editor",title:"Editor",...e||{}}}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]};return{...super.serialize(e),type:"form"}}clone(e){let t=new rw;return t.spec={...this.spec,...e||{}},t}}let rI=e=>new rw(e);var rC=Object.freeze({__proto__:null,ComponentViewBuilder:ry,FormViewBuilder:rw,GenericViewBuilder:rp,component:e=>new ry(e),form:rI,maybeSerializeView:rh}),r_=Object.defineProperty,rT=(e,t,n)=>t in e?r_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rk=(e,t,n)=>(rT(e,"symbol"!=typeof t?t+"":t,n),n);let rE=e=>{let{resolveDocumentNode:t,getClient:n}=e;return async(e,i)=>{let{params:r,path:o}=i,l=r.type,s=o.slice(0,o.length-1),a=o[o.length-1];if(l||(l=await ra(n,e)),!l)throw new iY("Failed to resolve document, and no type provided in parameters.",s,a);return t({documentId:e,schemaType:l})}};class rP{constructor(e,t){this._context=e,rk(this,"spec"),this.spec=t||{}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:ri(e,this.spec.id)})}getTitle(){return this.spec.title}child(e){return this.clone({child:e})}getChild(){return this.spec.child}documentId(e){let t=this.spec.id||e;return this.clone({id:t,options:{...this.spec.options||{},id:e}})}getDocumentId(){var e;return null==(e=this.spec.options)?void 0:e.id}schemaType(e){return this.clone({options:{...this.spec.options||{},type:"string"==typeof e?e:e.name}})}getSchemaType(){var e;return null==(e=this.spec.options)?void 0:e.type}initialValueTemplate(e,t){return this.clone({options:{...this.spec.options||{},template:e,templateParameters:t}})}getInitialValueTemplate(){var e;return null==(e=this.spec.options)?void 0:e.template}getInitialValueTemplateParameters(){var e;return null==(e=this.spec.options)?void 0:e.templateParameters}views(e){return this.clone({views:e})}getViews(){return this.spec.views||[]}serialize(){let{path:e=[],index:t,hint:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},i=e[t||e.length-1],r=this.spec.id||i&&"".concat(i)||"",o={id:r,type:void 0,template:void 0,templateParameters:void 0,...this.spec.options};if("string"!=typeof r||!r)throw new iY("`id` is required for document nodes",e,t,n).withHelpUrl(iG.ID_REQUIRED);if(!o||!o.id)throw new iY("document id (`id`) is required for document nodes",e,r,n).withHelpUrl(iG.DOCUMENT_ID_REQUIRED);if(!o||!o.type)throw new iY("document type (`schemaType`) is required for document nodes",e,r,n);let l=(this.spec.views&&this.spec.views.length>0?this.spec.views:[rI()]).map((t,n)=>rh(t,n,e)),s=l.map(e=>e.id),a=eL()(s.filter((e,t)=>s.includes(e,t+1)));if(a.length>0)throw new iY("document node has views with duplicate IDs: ".concat(a.join(",  ")),e,r,n);return{...this.spec,child:this.spec.child||rE(this._context),id:rn(r,e,t),type:"document",options:function(e){let t={id:e.id||"",type:e.type||"*"};return e.template&&(t.template=e.template),e.templateParameters&&(t.templateParameters=e.templateParameters),t}(o),views:l}}clone(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new rP(this._context),n={...this.spec.options||{},...e.options||{}};return t.spec={...this.spec,...e,options:n},t}}let rA=["default","card","media","detail","block"],rD=Symbol("Document type list canHandleIntent"),rS=(e,t,n)=>{var i,r;let{pane:o}=n,l="create"===e,s=(null==(i=o.options)?void 0:i.filter)||"",a=(null==(r=o.options)?void 0:r.params)||{},c=o.schemaTypeName?[o.schemaTypeName]:rG(s,a),d=o.initialValueTemplates||[];return l&&t.template?d.some(e=>e.templateId===t.template):"edit"===e&&t.id&&c.includes(t.type)||l&&c.includes(t.type)};rS.identity=rD;var rR=Object.defineProperty,rO=(e,t,n)=>t in e?rR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rz=(e,t,n)=>(rO(e,"symbol"!=typeof t?t+"":t,n),n);class rM{constructor(e,t){this._context=e,rz(this,"spec"),this.spec=t||{}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e})}getTitle(){return this.spec.title}description(e){return this.clone({description:e})}getDescription(){return this.spec.description}templateId(e){let t=this.spec.id||e;return this.clone({id:t,templateId:e})}getTemplateId(){return this.spec.templateId}parameters(e){return this.clone({parameters:e})}getParameters(){return this.spec.parameters}serialize(){let{path:e=[],index:t,hint:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{spec:i,_context:r}=this,{templates:o}=r;if("string"!=typeof i.id||!i.id)throw new iY("`id` is required for initial value template item nodes",e,t,n).withHelpUrl(iG.ID_REQUIRED);if(!i.templateId)throw new iY("template id (`templateId`) is required for initial value template item nodes",e,i.id,n).withHelpUrl(iG.ID_REQUIRED);let l=o.find(e=>e.id===i.templateId);if(!l)throw new iY("template id (`templateId`) is required for initial value template item nodes",e,i.id,n).withHelpUrl(iG.ID_REQUIRED);return{id:i.id,templateId:i.id,schemaType:l.schemaType,type:"initialValueTemplateItem",description:i.description||l.description,title:i.title||l.title,subtitle:i.subtitle,icon:i.icon||l.icon,initialDocumentId:i.initialDocumentId,parameters:i.parameters}}clone(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new rM(this._context);return t.spec={...this.spec,...e},t}}var rL=Object.defineProperty,rU=(e,t,n)=>t in e?rL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rN=(e,t,n)=>(rU(e,"symbol"!=typeof t?t+"":t,n),n);function rH(){}let rV=(e,t,n)=>{let{pane:i,index:r}=n;return r<=1&&rS(e,t,{pane:i,index:r})};class rB{constructor(){rN(this,"initialValueTemplatesSpecified",!1),rN(this,"spec",{})}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:ri(e,this.spec.id)})}getTitle(){return this.spec.title}defaultLayout(e){return this.clone({defaultLayout:e})}getDefaultLayout(){return this.spec.defaultLayout}menuItems(e){return this.clone({menuItems:e})}getMenuItems(){return this.spec.menuItems}menuItemGroups(e){return this.clone({menuItemGroups:e})}getMenuItemGroups(){return this.spec.menuItemGroups}child(e){return this.clone({child:e})}getChild(){return this.spec.child}canHandleIntent(e){return this.clone({canHandleIntent:e})}getCanHandleIntent(){return this.spec.canHandleIntent}showIcons(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this.clone({displayOptions:{...this.spec.displayOptions||{},showIcons:e}})}getShowIcons(){return this.spec.displayOptions?this.spec.displayOptions.showIcons:void 0}initialValueTemplates(e){return this.initialValueTemplatesSpecified=!0,this.clone({initialValueTemplates:Array.isArray(e)?e:[e]})}getInitialValueTemplates(){return this.spec.initialValueTemplates}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},t=this.spec.id||"",n=e.path,i=this.spec.defaultLayout;if(i&&!rA.includes(i))throw new iY("`layout` must be one of ".concat(rA.map(e=>'"'.concat(e,'"')).join(", ")),n,t||e.index,this.spec.title);let r=(this.spec.initialValueTemplates||[]).map((e,t)=>e instanceof rM?e.serialize({path:n,index:t}):e);return{id:rn(t,e.path,t||e.index),title:this.spec.title,type:"genericList",defaultLayout:i,child:this.spec.child||rH,canHandleIntent:this.spec.canHandleIntent||rV,displayOptions:this.spec.displayOptions,initialValueTemplates:r,menuItems:(this.spec.menuItems||[]).map((e,t)=>i2(e,t,n)),menuItemGroups:(this.spec.menuItemGroups||[]).map((e,t)=>i7(e,t,n))}}}var rZ=Object.defineProperty,rF=(e,t,n)=>t in e?rZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rq=(e,t,n)=>(rF(e,"symbol"!=typeof t?t+"":t,n),n);let r$=(e,t)=>{var n;let i=(null==(n=e.options)?void 0:n.filter.trim())||"";if(["*","{"].includes(i[0]))throw new iY("`filter` cannot start with `".concat(i[0],"` - looks like you are providing a query, not a filter"),t.path,e.id,e.title).withHelpUrl(iG.QUERY_PROVIDED_FOR_FILTER);return i},rQ=e=>(t,n)=>{var i;let r=n.parent,o=(null==(i=n.params)?void 0:i.template)?e.templates.find(e=>e.id===n.params.template):void 0,l=o?o.schemaType:r.schemaTypeName||ra(e.getClient,t);return Promise.resolve(l).then(n=>n?e.resolveDocumentNode({schemaType:n,documentId:t}):new rP(e).id("editor").documentId(t).schemaType(""))};class rY extends rB{constructor(e,t){super(),this._context=e,rq(this,"spec"),this.spec=t||{},this.initialValueTemplatesSpecified=!!(null==t?void 0:t.initialValueTemplates)}apiVersion(e){return this.clone({options:{...this.spec.options||{filter:""},apiVersion:e}})}getApiVersion(){var e;return null==(e=this.spec.options)?void 0:e.apiVersion}filter(e){return this.clone({options:{...this.spec.options||{},filter:e}})}getFilter(){var e;return null==(e=this.spec.options)?void 0:e.filter}schemaType(e){let t="string"==typeof e?e:e.name;return this.clone({schemaTypeName:t})}getSchemaType(){return this.spec.schemaTypeName}params(e){return this.clone({options:{...this.spec.options||{filter:""},params:e}})}getParams(){var e;return null==(e=this.spec.options)?void 0:e.params}defaultOrdering(e){if(!Array.isArray(e))throw Error("`defaultOrdering` must be an array of order clauses");return this.clone({options:{...this.spec.options||{filter:""},defaultOrdering:e}})}getDefaultOrdering(){var e;return null==(e=this.spec.options)?void 0:e.defaultOrdering}serialize(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]};if("string"!=typeof this.spec.id||!this.spec.id)throw new iY("`id` is required for document lists",t.path,t.index,this.spec.title).withHelpUrl(iG.ID_REQUIRED);if(!this.spec.options||!this.spec.options.filter)throw new iY("`filter` is required for document lists",t.path,this.spec.id,this.spec.title).withHelpUrl(iG.FILTER_REQUIRED);return{...super.serialize(t),type:"documentList",schemaTypeName:this.spec.schemaTypeName,child:this.spec.child||rQ(this._context),options:{...this.spec.options,apiVersion:this.spec.options.apiVersion||((null==(e=this.spec.options)?void 0:e.filter)==="_type == $type"?"2021-06-07":"1"),filter:r$(this.spec,t)}}}clone(e){let t=new rY(this._context);return t.spec={...this.spec,...e||{}},this.initialValueTemplatesSpecified||(t.spec.initialValueTemplates=function(e,t){let{document:n}=e,{schemaTypeName:i,options:r}=t,{filter:o,params:l}=r||{filter:"",params:{}},s=i?[i]:Array.from(new Set(rG(o,l)));if(0!==s.length)return s.flatMap(e=>n.resolveNewDocumentOptions({type:"structure",schemaType:e})).map(e=>({...e,icon:$.j29}))}(this._context,t.spec)),t.spec.schemaTypeName||(t.spec.schemaTypeName=function(e){let{options:t}=e,{filter:n,params:i}=t||{filter:"",params:{}},r=rG(n,i);return 1===r.length?r[0]:void 0}(t.spec)),t}getSpec(){return this.spec}}function rG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=/\b_type\s*==\s*(['"].*?['"]|\$.*?(?:\s|$))|\B(['"].*?['"]|\$.*?(?:\s|$))\s*==\s*_type/g,r=[];for(;null!==(t=i.exec(e));)r.push(t[1]||t[2]);return r.map(e=>{let t="$"===e[0]?n[e.slice(1)]:e,i=(t||"").trim().replace(/^["']|["']$/g,"");return i}).filter(Boolean)}(e,t);return 0===n.length&&(n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(/\b_type\s+in\s+\[(.*?)\]/);return n?n[1].split(/,\s*/).map(e=>e.trim().replace(/^["']+|["']+$/g,"")).map(e=>"$"===e[0]?t[e.slice(1)]:e).filter(Boolean):[]}(e,t)),n}var rW=Object.defineProperty,rX=(e,t,n)=>t in e?rW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rJ=(e,t,n)=>(rX(e,"symbol"!=typeof t?t+"":t,n),n);let rK=e=>e instanceof r3?"ListBuilder":(0,G.Uy$)(e)&&"function"==typeof e.then?"Promise":Array.isArray(e)?"array":typeof e,r0=e=>"listItem"===e.type,r1=(e,t,n)=>{let i=n.pane,r=i.items||[];return r.filter(oi).some(e=>e.schemaType.name===t.type&&e._id===t.id)||rV(e,t,n)},r2=(e,t)=>{let n=t.parent,i=n.items.filter(r0),r=(i.find(t=>t.id===e)||{child:void 0}).child;return r&&"function"==typeof r&&"function"==typeof r?r(e,t):r};class r3 extends rB{constructor(e,t){super(),this._context=e,rJ(this,"spec"),this.spec=t||{},this.initialValueTemplatesSpecified=!!(t&&t.initialValueTemplates)}items(e){return this.clone({items:e})}getItems(){return this.spec.items}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},t=this.spec.id;if("string"!=typeof t||!t)throw new iY("`id` is required for lists",e.path,e.index).withHelpUrl(iG.ID_REQUIRED);let n=void 0===this.spec.items?[]:this.spec.items;if(!Array.isArray(n))throw new iY("`items` must be an array of items",e.path,e.index).withHelpUrl(iG.LIST_ITEMS_MUST_BE_ARRAY);let i=(e.path||[]).concat(t),r=n.map((e,t)=>(function(e,t,n){if(e instanceof r9)return e.serialize({path:n,index:t});if(e&&"divider"===e.type)return e;if(!e||"listItem"!==e.type){let i=e&&e.type||rK(e);throw new iY('List items must be of type "listItem", got "'.concat(i,'"').concat("array"===i?" - did you forget to spread (...moreItems)?":""),n,t).withHelpUrl(iG.INVALID_LIST_ITEM)}return e})(e,t,i)),o=r.filter((e,t)=>eZ()(r,{id:e.id},t+1));if(o.length>0){let t=o.map(e=>e.id).slice(0,5),n=o.length>5?"".concat(t.join(", "),"..."):t.join(", ");throw new iY("List items with same ID found (".concat(n,")"),e.path,e.index).withHelpUrl(iG.LIST_ITEM_IDS_MUST_BE_UNIQUE)}return{...super.serialize(e),type:"list",canHandleIntent:this.spec.canHandleIntent||r1,child:this.spec.child||r2,items:r}}clone(e){let t=new r3(this._context);return t.spec={...this.spec,...e||{}},t}}var r5=Object.defineProperty,r4=(e,t,n)=>t in e?r5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,r8=(e,t,n)=>(r4(e,"symbol"!=typeof t?t+"":t,n),n);class r9{constructor(e,t){this._context=e,r8(this,"spec"),this.spec=t||{}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:ri(e,this.spec.id)})}getTitle(){return this.spec.title}icon(e){return this.clone({icon:e})}showIcon(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this.clone({displayOptions:{...this.spec.displayOptions||{},showIcon:e}})}getShowIcon(){return this.spec.displayOptions?this.spec.displayOptions.showIcon:void 0}getIcon(){return this.spec.icon}child(e){return this.clone({child:e})}getChild(){return this.spec.child}schemaType(e){return this.clone({schemaType:e})}getSchemaType(){let e=this.spec.schemaType;return"string"==typeof e?this._context.schema.get(e):this.spec.schemaType}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{id:t,title:n,child:i}=this.spec;if("string"!=typeof t||!t)throw new iY("`id` is required for list items",e.path,e.index).withHelpUrl(iG.ID_REQUIRED);if(!e.titleIsOptional&&("string"!=typeof n||!n))throw new iY("`title` is required for list items",e.path,t).withHelpUrl(iG.TITLE_REQUIRED);let r=this.spec.schemaType;if("string"==typeof r){let n=this._context.schema.get(r);if(!n)throw new iY('Could not find type "'.concat(r,'" in schema'),e.path,t).withHelpUrl(iG.SCHEMA_TYPE_NOT_FOUND);r=n}let o={path:e.path.concat(t),hint:"child"},l=i instanceof rs||i instanceof rY||i instanceof rP||i instanceof r3?i.serialize(o):i;if("function"==typeof l){let e=l;l=(t,n)=>e(t,{...n,serializeOptions:o})}return{...this.spec,id:rn(t,e.path,e.index),schemaType:r,child:l,title:n,type:"listItem"}}clone(e){let t=new r9(this._context);return t.spec={...this.spec,...e||{}},t}}var r6=Object.defineProperty,r7=(e,t,n)=>t in e?r6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oe=(e,t,n)=>(r7(e,"symbol"!=typeof t?t+"":t,n),n);let ot=(e,t)=>n=>{let i=t.schemaType&&("string"==typeof t.schemaType?t.schemaType:t.schemaType.name);return i?e.resolveDocumentNode({schemaType:i,documentId:n}):new rP(e).id("documentEditor").documentId(n)};class on extends r9{constructor(e,t){super(e,t),this._context=e,oe(this,"spec"),this.spec=t||{}}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},t=super.serialize({...e,titleIsOptional:!0});if(!t.schemaType)throw new iY("`schemaType` is required for document list items",e.path,e.index).withHelpUrl(iG.SCHEMA_TYPE_REQUIRED);let n=t.child||ot(this._context,t);return{...t,child:n,schemaType:t.schemaType,_id:t.id}}clone(e){let t=new on(this._context);return t.spec={...this.spec,...e||{}},t}}function oi(e){return(0,G.Uy$)(e)&&void 0!==e.schemaType&&"string"==typeof e._id}var or=Object.defineProperty,oo=(e,t,n)=>t in e?or(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ol=(e,t,n)=>(oo(e,"symbol"!=typeof t?t+"":t,n),n);class os extends rY{constructor(e,t){super(e),this._context=e,ol(this,"spec"),this.spec=t||{}}child(e){return this.cloneWithoutDefaultIntentHandler({child:e})}clone(e){let t=super.clone(e),n=new os(this._context);return n.spec={...this.spec,...t.getSpec(),...e||{}},n}cloneWithoutDefaultIntentHandler(e){let t=super.clone(e),n=new os(this._context),i=this.spec.canHandleIntent,r=i&&i.identity===rD;return n.spec={...t.getSpec(),...this.spec,...e||{},...r?{canHandleIntent:void 0}:{}},n}}let oa=["sanity.imageAsset","sanity.fileAsset"];function oc(e){let t=function(e){let{schema:t}=e;return t.getTypeNames().filter(e=>{var n;let i=t.get(e);return i&&(null==(n=i.type)?void 0:n.name)==="document"}).filter(e=>!oa.includes(e))}(e);return t.map(t=>od(e,t))}function od(e,t){let{schema:n}=e,i=n.get(t);if(!i)throw Error('Schema type with name "'.concat(t,'" not found'));let r=i.title||eY()(t);return new r9(e).id(t).title(r).schemaType(i).child((n,i)=>{let r=i.parent,o="list"===r.type?r.items.find(e=>e.id===n):null,l=ou(e,t);return o&&o.title&&(l=l.title(o.title)),l})}function ou(e,t){let{schema:n,resolveDocumentNode:i}=e,r="string"==typeof t?t:t.schemaType,o="string"==typeof r?r:r.name,l="string"==typeof t?{schemaType:r}:t,s=n.get(o);if(!s)throw Error('Schema type with name "'.concat(o,'" not found'));let a=s.title||eY()(o),c=function(e){let t=e.preview;return!!(t&&(t.prepare||t.select&&t.select.media))}(s);return new os(e).id(l.id||o).title(l.title||a).filter("_type == $type").params({type:o}).schemaType(s).showIcons(c).defaultOrdering(iX.by).menuItemGroups(l.menuItemGroups||[{id:"sorting",title:"Sort"},{id:"layout",title:"Layout"},{id:"actions",title:"Actions"}]).child(l.child||(e=>i({schemaType:o,documentId:e}))).canHandleIntent(l.canHandleIntent||rS).menuItems(l.menuItems||[...i4(e,s),new i3(e).group("layout").title("Compact view").icon($.reJ).action("setLayout").params({layout:"default"}),new i3(e).group("layout").title("Detailed view").icon($.cMY).action("setLayout").params({layout:"detail"})])}function op(e){let{defaultDocumentNode:t,structure:n,children:i}=e,[r,o]=(0,Q.useState)(!1),l=(0,G.Lky)(),s=(0,G.Q3k)(l),a=(0,G.H__)(),c=(0,Q.useMemo)(()=>(function(e){let{defaultDocumentNode:t,source:n}=e,i=(0,G.nqf)(n),r={...n,getStructureBuilder:()=>o,resolveDocumentNode:e=>{let n=(null==t?void 0:t(o,{...e,...i}))||new rP(r);return n.getId()||(n=n.id("documentEditor")),e.documentId&&(n=n.documentId((0,G.vsM)(e.documentId))),n.schemaType(e.schemaType)}},o={defaults:()=>(function(e){let t=oc(e);return new r3(e).id("__root__").title("Content").items(t).showIcons(t.some(e=>{var t;return!!(t=e.getSchemaType())&&"string"!=typeof t&&!!t.icon}))})(r),documentTypeList:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return ou(r,...t)},documentTypeListItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return od(r,...t)},documentTypeListItems:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return oc(r,...t)},document:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new rP(r,...t)},documentWithInitialValueTemplate:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t,n){let{resolveDocumentNode:i,templates:r}=e,o=r.find(e=>e.id===t);if(!o)throw Error('Template with ID "'.concat(t,'" not defined'));return i({schemaType:o.schemaType}).initialValueTemplate(t,n)}(r,...t)},defaultDocument:r.resolveDocumentNode,list:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new r3(r,...t)},listItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new r9(r,...t)},menuItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new i3(r,...t)},menuItemGroup:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new re(r,...t)},menuItemsFromInitialValueTemplateItems:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t){let{schema:n,templates:i}=e;return t.map(t=>{let r=i.find(e=>e.id===t.templateId),o=t.title||(null==r?void 0:r.title)||"Create new",l=eV()({type:r&&r.schemaType,template:t.templateId},Boolean),s=t.parameters?[l,t.parameters]:l,a=r&&n.get(r.schemaType);return new i3(e).title(o).icon(r&&r.icon||(null==a?void 0:a.icon)||$.j29).intent({type:"create",params:s}).serialize()})}(r,...t)},documentList:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new rY(r,...t)},documentListItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new on(r,...t)},orderingMenuItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i5(r,...t)},orderingMenuItemsForType:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i4(r,...t)},editor:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t){let n=(null==t?void 0:t.type)?e.resolveDocumentNode({schemaType:t.type}):new rP(e);if(!t)return n;let{id:i,type:r,template:o,templateParameters:l}=t.options;return n=n.id(t.id).documentId(i),r&&(n=n.schemaType(r)),o&&(n=n.initialValueTemplate(o,l)),t.child&&(n=n.child(t.child)),n}(r,...t)},defaultInitialValueTemplateItems:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){let{schema:t,getStructureBuilder:n,templates:i}=e,r=t.getTypeNames(),o=i.filter(e=>{var t;return!(null==(t=e.parameters)?void 0:t.length)}).sort((e,t)=>r.indexOf(e.schemaType)-r.indexOf(t.schemaType));return o.map(e=>n().initialValueTemplateItem(e.id))}(r,...t)},initialValueTemplateItem:(e,t)=>new rM(r,{id:e,parameters:t,templateId:e}),component:e=>(0,e$.isValidElementType)(e)?new rs().component(e):new rs(e),divider:()=>({id:eq()("__divider__"),type:"divider"}),view:rC,context:r};return o})({defaultDocumentNode:t,source:l}),[t,l]),d=(0,Q.useMemo)(()=>n?n(c,{...s,documentStore:a}):c.defaults(),[c,n,s,a]),u=(0,Q.useMemo)(()=>({backButton:r,resizablePanes:!r,reviewChanges:!r,splitPanes:!r,splitViews:!r}),[r]),p=(0,Q.useMemo)(()=>({features:u,layoutCollapsed:r,setLayoutCollapsed:o,rootPaneNode:d,structureContext:c.context}),[u,r,d,c.context]);return(0,Y.jsx)(n1.Provider,{value:p,children:i})}}}]);